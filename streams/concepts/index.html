<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-streams/concepts">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Macrometa" href="/docs/opensearch.xml">


<link rel="preconnect" href="https://posthog.prod.macrometa.io">
<script>!function(t,o){var e,p,n,i;o.__SV||(window.posthog=o,o._i=[],o.init=function(r,s,a){function c(t,o){var e=o.split(".");2==e.length&&(t=t[e[0]],o=e[1]),t[o]=function(){t.push([o].concat(Array.prototype.slice.call(arguments,0)))}}(n=t.createElement("script")).type="text/javascript",n.async=!0,n.src=s.api_host+"/static/array.js",(i=t.getElementsByTagName("script")[0]).parentNode.insertBefore(n,i);var g=o;for(void 0!==a?g=o[a]=[]:a="posthog",g.people=g.people||[],g.toString=function(t){var o="posthog";return"posthog"!==a&&(o+="."+a),t||(o+=" (stub)"),o},g.people.toString=function(){return g.toString(1)+".people (stub)"},e="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset".split(" "),p=0;p<e.length;p++)c(g,e[p]);o._i.push([r,s,a])},o.__SV=1)}(document,window.posthog||[]),posthog.init("phc_9S9df0RqQSuCLsW1CPln4f5XtZDUFwnp4abg1N2EHxb",{api_host:"https://posthog.prod.macrometa.io"})</script><title data-rh="true">Concepts | Macrometa</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://macrometa.com/docs/img/map.png"><meta data-rh="true" name="twitter:image" content="https://macrometa.com/docs/img/map.png"><meta data-rh="true" property="og:url" content="https://macrometa.com/docs/streams/concepts"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="Macrometa Docs"><meta data-rh="true" name="og:description" content="Powering the next generation of apps and APIs. Build performant apps on the edge with our lightning-fast, stateful serverless global data platform"><meta data-rh="true" name="og:url" content="https://macrometa.com/docs/"><meta data-rh="true" name="og:image" content="https://assets-global.website-files.com/5fa9e94bc848ae335afdd627/601af89de27f422a1c090b14_mm-map.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Concepts | Macrometa"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://macrometa.com/docs/streams/concepts"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/streams/concepts" hreflang="en"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/streams/concepts" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GHXKYI4VEC-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs/assets/css/styles.1c3e448a.css">
<link rel="preload" href="/docs/assets/js/runtime~main.695a231d.js" as="script">
<link rel="preload" href="/docs/assets/js/main.b8dbb911.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://macrometa.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="Macrometa Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docs/img/logo-white.svg" alt="Macrometa Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Docs</a><a class="navbar__item navbar__link" href="/docs/api">API</a><a href="https://github.com/macrometacorp/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/essentials/overview">Essentials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/collections/keyvalue/quickstart">Collections</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/search/overview">Search</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/queryworkers/concepts">Query Workers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/streams/concepts">Streams</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/streams/concepts">Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/streams/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/streams/tutorials/using_rest_api">Tutorials</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cep/quickstart">Stream Workers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/c8ql/introduction">C8 Query Language</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/cloudflare-workers">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/apps/address-book">Sample Apps</a></div></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Streams</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Concepts</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Concepts</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>Streams in GDN is built on the <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern" target="_blank" rel="noopener noreferrer">publish-subscribe</a> pattern, aka pub-sub. In this pattern, producers publish messages to streams. Consumers can then subscribe to those streams, process incoming messages, and send an acknowledgement when processing is complete.</p><p>Once a subscription has been created, all messages will be retained by GDN streams, even if the consumer gets disconnected. Retained messages will be discarded only when a consumer acknowledges that they&#x27;ve been successfully processed.</p><p>As in other pub-sub systems, streams in GDN are named channels for transmitting messages from producers to consumers. Stream names are URLs that have a well-defined structure:</p><div class="language-http codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-http codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">persistent://tenant/geofabric/stream-name</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Stream name component</th><th>Description</th></tr></thead><tbody><tr><td><code>persistent</code></td><td>This identifies the type of stream. GDN currently supports only persistent streams. With persistent streams, all messages are durably persistedon disk (that means on multiple disks).</td></tr><tr><td><code>tenant</code></td><td>The stream tenant within the instance. Tenants are essential to multi-tenancy in GDN</td></tr><tr><td><code>geofabric</code></td><td>The administrative unit of the stream, which acts as a grouping and geo-fencing mechanism for related streams. Stream configuration is performed at the geofabric level. Each tenant can have multiple geofabrics.</td></tr><tr><td><code>stream</code></td><td>The final part of the name. Stream names are freeform.</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Every collection within a geofabric is also a stream with same name.</p></div></div><p>A geofabric is a geo-fenced grouping within a tenant. A tenant can create multiple geofabrics. For instance, a tenant with different applications can create a separate geofabric for each application. A geofabric allows the application to create and manage a hierarchy of streams. The stream <code>my-tenant/app1</code> is a geofabric for the application <code>app1</code> for <code>my-tenant</code>. You can create any number of <code>streams</code> under the geofabric.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="messages">Messages<a class="hash-link" href="#messages" title="Direct link to heading">​</a></h2><p>Messages are the basic <code>unit</code> of GDN streams. They&#x27;re what producers publish to streams and what consumers then consume from streams (and acknowledge when the message has been processed). Messages are the analogue of letters in a postal service system.</p><table><thead><tr><th>Component</th><th>Purpose</th></tr></thead><tbody><tr><td>Value / data payload</td><td>The data carried by the message. All GDN stream messages carry raw bytes, although message data can also conform to data schemas in future</td></tr><tr><td>Key</td><td>Messages can optionally be tagged with keys, which can be useful for things like stream compaction</td></tr><tr><td>Properties</td><td>An optional key/value map of user-defined properties</td></tr><tr><td>Producer name</td><td>The name of the producer that produced the message (producers are automatically given default names, but you can apply your own explicitly as well)</td></tr><tr><td>Sequence ID</td><td>Each GDN stream message belongs to an ordered sequence on its stream. A message&#x27;s sequence ID is its ordering in that sequence.</td></tr><tr><td>Publish time</td><td>The timestamp of when the message was published (automatically applied by the producer)</td></tr><tr><td>Event time</td><td>An optional timestamp that applications can attach to the message representing when something happened, e.g. when the message was processed. The event time of a message is 0 if none is explicitly set.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="producers">Producers<a class="hash-link" href="#producers" title="Direct link to heading">​</a></h2><p>A producer is a process that attaches to a stream and publishes messages to a C8 for processing.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="send-modes">Send modes<a class="hash-link" href="#send-modes" title="Direct link to heading">​</a></h3><p>Producers can send messages to GDN  either synchronously (sync) or asynchronously (async).</p><table><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>Sync send</td><td>The producer will wait for acknowledgement from the broker after sending each message. If acknowledgment isn&#x27;t received then the producer will consider the send operation a failure</td></tr><tr><td>Async send</td><td>The producer will put the message in a blocking queue and return immediately. The client library will then send the message to the broker in the background. If the queue is full, the producer could be blocked or fail immediately when calling the API, depending on arguments passed to the producer.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="compression">Compression<a class="hash-link" href="#compression" title="Direct link to heading">​</a></h3><p>Messages published by producers can be compressed during transportation in order to save bandwidth. C8 streams currently supports two types of compression:</p><ul><li><a href="https://github.com/lz4/lz4" target="_blank" rel="noopener noreferrer">LZ4</a></li><li><a href="https://zlib.net/" target="_blank" rel="noopener noreferrer">ZLIB</a></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="batching">Batching<a class="hash-link" href="#batching" title="Direct link to heading">​</a></h3><p>If batching is enabled, the producer will accumulate and send a batch of messages in a single request. Batching size is defined by the maximum number of messages and maximum publish latency.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="consumers">Consumers<a class="hash-link" href="#consumers" title="Direct link to heading">​</a></h2><p>A consumer is a process that attaches to a stream via a subscription and then receives messages.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="receive-modes">Receive modes<a class="hash-link" href="#receive-modes" title="Direct link to heading">​</a></h3><p>Messages can be received from C8  either synchronously (sync) or asynchronously (async).</p><table><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td>Sync receive</td><td>A sync receive will be blocked until a message is available.</td></tr><tr><td>Async receive</td><td>An async receive will return immediately with a future value</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="acknowledgement">Acknowledgement<a class="hash-link" href="#acknowledgement" title="Direct link to heading">​</a></h3><p>When a consumer has successfully processed a message, it needs to send an acknowledgement to the GDN so that GDN can discard the message (otherwise it stores the message).</p><p>Messages can be acknowledged either one by one or cumulatively. With cumulative acknowledgement, the consumer only needs to acknowledge the last message it received. All messages in the stream up to (and including) the provided message will not be re-delivered to that consumer.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Cumulative acknowledgement cannot be used with <code>shared subscription mode</code>, because shared mode involves multiple consumers having access to the same subscription.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="listeners">Listeners<a class="hash-link" href="#listeners" title="Direct link to heading">​</a></h3><p>Client libraries can provide their own listener implementations for consumers. In this interface, the <code>received</code> method is called whenever a new message is received.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="subscription-modes">Subscription Modes<a class="hash-link" href="#subscription-modes" title="Direct link to heading">​</a></h2><p>A subscription is a named configuration rule that determines how messages are delivered to consumers. There are three available subscription modes in GDN streams: <a href="#exclusive">exclusive</a>, <a href="#shared">shared</a>, and <a href="#failover">failover</a>. These modes are illustrated in the figure below.</p><p><img loading="lazy" alt="stream-subscription-modes" src="/docs/assets/images/stream-subscription-modes-6f625a15e431a46508d86f64cec68429.png" width="1846" height="1332" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="exclusive">Exclusive<a class="hash-link" href="#exclusive" title="Direct link to heading">​</a></h3><p>In <code>exclusive</code> mode, only a single consumer is allowed to attach to the subscription. If more than one consumer attempts to subscribe to a stream using the same subscription, the consumer receives an error.</p><p>In the diagram above, only <strong>Consumer-A</strong> is allowed to consume messages.</p><blockquote><p>Exclusive mode is the default subscription mode.</p></blockquote><p><img loading="lazy" alt="stream-exclusive-subscriptions" src="/docs/assets/images/stream-exclusive-subscriptions-14a3026a4d166b4d5d90ea18a4628f36.png" width="2010" height="730" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="shared">Shared<a class="hash-link" href="#shared" title="Direct link to heading">​</a></h3><p>In <code>shared</code> or <code>round robin</code> mode, multiple consumers can attach to the same subscription. Messages are delivered in a round robin distribution across consumers, and any given message is delivered to only one consumer. When a consumer disconnects, all the messages that were sent to it and not acknowledged will be rescheduled for sending to the remaining consumers.</p><p>In the diagram above, <strong>Consumer-B-1</strong> and <strong>Consumer-B-2</strong> are able to subscribe to the stream, but <strong>Consumer-C-1</strong> and others could as well.</p><p><strong>Limitations of shared mode:</strong></p><p>There are two important things to be aware of when using shared mode:</p><ul><li>Message ordering is not guaranteed.</li><li>You cannot use cumulative acknowledgment with shared mode.</li></ul><p><img loading="lazy" alt="stream-shared-subscriptions" src="/docs/assets/images/stream-shared-subscriptions-72441c09d01cd35f451cd4b41b247639.png" width="1848" height="780" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="failover">Failover<a class="hash-link" href="#failover" title="Direct link to heading">​</a></h3><p>In <code>failover</code> mode, multiple consumers can attach to the same subscription. The consumers will be lexically sorted by the consumer&#x27;s name and the first consumer will initially be the only one receiving messages. This consumer is called the <code>master consumer</code>.</p><p>When the master consumer disconnects, all (non-acked and subsequent) messages will be delivered to the next consumer in line.</p><p>In the diagram above, <strong>Consumer-C-1</strong> is the master consumer while <strong>Consumer-C-2</strong> would be the next in line to receive messages if <strong>Consumer-C-1</strong> disconnected.</p><p><img loading="lazy" alt="stream-failover-subscriptions" src="/docs/assets/images/stream-failover-subscriptions-8fca08ff42b1ef0ff53ef383f5be42be.png" width="1834" height="734" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="multi-stream-subscriptions">Multi-stream Subscriptions<a class="hash-link" href="#multi-stream-subscriptions" title="Direct link to heading">​</a></h2><p>When a consumer subscribes to a GDN stream, by default it subscribes to one specific stream, such as <code>persistent://tenant1/fabric1/my-stream</code>. GDN stream consumers can simultaneously subscribe to multiple streams. You can define a list of streams in two ways:</p><ul><li>On the basis of a <a href="https://en.wikipedia.org/wiki/Regular_expression" target="_blank" rel="noopener noreferrer"><strong>reg</strong>ular <strong>ex</strong>pression</a> (regex), for example <code>persistent://tenant1/fabric1/finance-.*</code></li><li>By explicitly defining a list of streams</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>When subscribing to multiple streams by regex, all streams must be in the same <code>geofabric</code>.</p></div></div><p>When subscribing to multiple streams, the GDN stream client will automatically make a call to the GDN API to discover the streams that match the regex pattern/list and then subscribe to all of them. If any of the streams don&#x27;t currently exist, the consumer will auto-subscribe to them once the streams are created.</p><p><strong>No ordering guarantees:</strong></p><p>When a consumer subscribes to multiple streams, all ordering guarantees normally provided by GDN on single stream do not hold. If your use case for GDN involves any strict ordering requirements, we would strongly recommend against using this feature.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="stream-as-message-queue">Stream as Message Queue<a class="hash-link" href="#stream-as-message-queue" title="Direct link to heading">​</a></h2><p>Message queues are essential components of many large-scale data architectures. If every single work object that passes through your system absolutely <code>must</code> be processed in spite of the slowness or downright failure of this or that system component, there&#x27;s a good chance that you&#x27;ll need a message queue to step in and ensure that unprocessed data is retained---with correct ordering---until the required actions are taken.</p><p>GDN Streams is a great choice for a message queue because:</p><ul><li>it was built with persistent storage in mind</li><li>it offers automatic load balancing across consumers for messages on a stream</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can use the same GDN stream to act as a real-time message bus and as a message queue if you wish (or just one or the other)</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can set aside some streams for real-time purposes and other streams for message queue purposes (or use specific geofabrics for either purpose if you wish).</p></div></div><p><strong>Client configuration changes:</strong></p><p>To use a stream as a message queue, you should distribute the receiver load on that topic across several consumers (the optimal number of consumers will depend on the load). </p><p>Each consumer must:</p><ul><li><p>Establish a <a href="#shared">shared subscription</a> and use the same subscription name as the other consumers (otherwise the subscription is not shared and the consumers can&#x27;t act as a processing ensemble)</p></li><li><p>If you&#x27;d like to have tight control over message dispatching across consumers, set the consumers&#x27; <strong>receiver queue</strong> size very low (potentially even to 0 if necessary).</p></li></ul><p>Each Stream has a receiver queue that determines how many messages the consumer will attempt to fetch at a time. A receiver queue of 1000 (the default), for example, means that the consumer will attempt to process 1000 messages from the stream&#x27;s backlog upon connection. Setting the receiver queue to zero essentially means ensuring that each consumer is only doing one thing at a time.</p><p>The downside to restricting the receiver queue size of consumers is that that limits the potential throughput of those consumers. Whether the performance/control trade-off is worthwhile will depend on your use case.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="message-retention-and-expiry">Message Retention and Expiry<a class="hash-link" href="#message-retention-and-expiry" title="Direct link to heading">​</a></h2><p>By default, GDN:</p><ul><li>immediately delete <code>all</code> messages that have been acknowledged by a consumer, and</li><li>persistently store all unacknowledged messages in a message backlog for upto 3 days.</li></ul><p>GDN streams has two features, however, that enable you to override this default behavior:</p><ul><li>Message <strong>retention</strong> enables you to store messages that have been acknowledged by a consumer</li><li>Message <strong>expiry</strong> enables you to set a time to live (TTL) for messages that have not yet been acknowledged</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>All message retention and expiry is managed at the <code>geofabric</code> level.</p></div></div><p>The diagram below illustrates both concepts:</p><p><img loading="lazy" alt="stream-retention-expiry" src="/docs/assets/images/stream-retention-expiry-0cbc1fc12ef1d2620a801624838246b6.png" width="1769" height="965" class="img_E7b_"></p><p>With message retention, shown at the top, a <code>retention policy</code> applied to all streams in a database dicates that some messages are durably stored in GDN even though they&#x27;ve already been acknowledged. Acknowledged messages that are not covered by the retention policy are <code>deleted</code>. Without a retention policy, <code>all</code> of the <code>acknowledged messages</code> would be deleted.</p><p>With message expiry, shown at the bottom, some messages are <code>deleted</code>, even though they <code>haven&#x27;t been acknowledged</code>, because they&#x27;ve expired according to the <code>TTL applied to the namespace</code> (for example because a TTL of 5 minutes has been applied and the messages haven&#x27;t been acknowledged but are 10 minutes old).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/macrometacorp/docs/edit/master/docs/streams/concepts.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/queryworkers/tutorial"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tutorials</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/streams/quickstart"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Quickstart</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#messages" class="table-of-contents__link toc-highlight">Messages</a></li><li><a href="#producers" class="table-of-contents__link toc-highlight">Producers</a><ul><li><a href="#send-modes" class="table-of-contents__link toc-highlight">Send modes</a></li><li><a href="#compression" class="table-of-contents__link toc-highlight">Compression</a></li><li><a href="#batching" class="table-of-contents__link toc-highlight">Batching</a></li></ul></li><li><a href="#consumers" class="table-of-contents__link toc-highlight">Consumers</a><ul><li><a href="#receive-modes" class="table-of-contents__link toc-highlight">Receive modes</a></li><li><a href="#acknowledgement" class="table-of-contents__link toc-highlight">Acknowledgement</a></li><li><a href="#listeners" class="table-of-contents__link toc-highlight">Listeners</a></li></ul></li><li><a href="#subscription-modes" class="table-of-contents__link toc-highlight">Subscription Modes</a><ul><li><a href="#exclusive" class="table-of-contents__link toc-highlight">Exclusive</a></li><li><a href="#shared" class="table-of-contents__link toc-highlight">Shared</a></li><li><a href="#failover" class="table-of-contents__link toc-highlight">Failover</a></li></ul></li><li><a href="#multi-stream-subscriptions" class="table-of-contents__link toc-highlight">Multi-stream Subscriptions</a></li><li><a href="#stream-as-message-queue" class="table-of-contents__link toc-highlight">Stream as Message Queue</a></li><li><a href="#message-retention-and-expiry" class="table-of-contents__link toc-highlight">Message Retention and Expiry</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/essentials/overview">Essentials</a></li></ul></div><div class="col footer__col"><div class="footer__title">SDKs &amp; Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Macrometacorp/jsC8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Javascript<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Macrometacorp/pyC8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.npmjs.com/package/gdnsl" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/macrometa" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/macrometacorp/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Macrometa</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.695a231d.js"></script>
<script src="/docs/assets/js/main.b8dbb911.js"></script>
</body>
</html>