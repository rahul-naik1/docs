<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cep/reference/query-guide">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Macrometa" href="/docs/opensearch.xml">


<link rel="preconnect" href="https://posthog.prod.macrometa.io">
<script>!function(t,o){var e,p,n,i;o.__SV||(window.posthog=o,o._i=[],o.init=function(r,s,a){function c(t,o){var e=o.split(".");2==e.length&&(t=t[e[0]],o=e[1]),t[o]=function(){t.push([o].concat(Array.prototype.slice.call(arguments,0)))}}(n=t.createElement("script")).type="text/javascript",n.async=!0,n.src=s.api_host+"/static/array.js",(i=t.getElementsByTagName("script")[0]).parentNode.insertBefore(n,i);var g=o;for(void 0!==a?g=o[a]=[]:a="posthog",g.people=g.people||[],g.toString=function(t){var o="posthog";return"posthog"!==a&&(o+="."+a),t||(o+=" (stub)"),o},g.people.toString=function(){return g.toString(1)+".people (stub)"},e="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset".split(" "),p=0;p<e.length;p++)c(g,e[p]);o._i.push([r,s,a])},o.__SV=1)}(document,window.posthog||[]),posthog.init("phc_9S9df0RqQSuCLsW1CPln4f5XtZDUFwnp4abg1N2EHxb",{api_host:"https://posthog.prod.macrometa.io"})</script><title data-rh="true">Query Guide | Macrometa</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://macrometa.com/docs/img/map.png"><meta data-rh="true" name="twitter:image" content="https://macrometa.com/docs/img/map.png"><meta data-rh="true" property="og:url" content="https://macrometa.com/docs/cep/reference/query-guide"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="Macrometa Docs"><meta data-rh="true" name="og:description" content="Powering the next generation of apps and APIs. Build performant apps on the edge with our lightning-fast, stateful serverless global data platform"><meta data-rh="true" name="og:url" content="https://macrometa.com/docs/"><meta data-rh="true" name="og:image" content="https://assets-global.website-files.com/5fa9e94bc848ae335afdd627/601af89de27f422a1c090b14_mm-map.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Query Guide | Macrometa"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://macrometa.com/docs/cep/reference/query-guide"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/cep/reference/query-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://macrometa.com/docs/cep/reference/query-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GHXKYI4VEC-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs/assets/css/styles.1c3e448a.css">
<link rel="preload" href="/docs/assets/js/runtime~main.695a231d.js" as="script">
<link rel="preload" href="/docs/assets/js/main.b8dbb911.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://macrometa.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="Macrometa Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docs/img/logo-white.svg" alt="Macrometa Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Docs</a><a class="navbar__item navbar__link" href="/docs/api">API</a><a href="https://github.com/macrometacorp/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/essentials/overview">Essentials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/collections/keyvalue/quickstart">Collections</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/search/overview">Search</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/queryworkers/concepts">Query Workers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/streams/concepts">Streams</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/cep/quickstart">Stream Workers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/cep/tutorials/using_rest_api">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/cep/reference/overview">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/basics">Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/values-n-types">Values &amp; Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/data-cleansing">Data Cleansing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/data-transformation">Data Transformation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/data-summarization">Data Summarizations (Aggregations)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/patterns-n-trends">Patterns &amp; Trends</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/data-pipelining">Data Pipelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/error-handling">Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/geospatial">Geospatial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cep/reference/query-guide">Query Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/functions">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/limits">Limits</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cep/reference/query-language-update">Query Language Syntax Update</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/cep/reference/extensions/execution/context">Extensions</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/c8ql/introduction">C8 Query Language</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/cloudflare-workers">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/apps/address-book">Sample Apps</a></div></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Stream Workers</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Query Guide</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Query Guide</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>Macrometa Stream QL is designed to process streams of events. It can be used to implement streaming data integration, streaming analytics, rule based and
adaptive decision making use cases. It is an evolution of Complex Event Processing (CEP) and Stream Processing systems, hence it can also be used to process stateful computations, detecting of complex event patterns, and sending notifications in real-time.</p><p>Stream QL uses SQL like syntax, and annotations to consume events from diverse event sources with various data formats, process then using stateful and stateless operators and send outputs to multiple endpoints according to their accepted event formats. It also supports exposing rule based and adaptive decision making as service endpoints such that external programs and systems can synchronously get decision support form Stream.  </p><p>The following sections explains how to write processing logic using Stream QL.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="stream-application">Stream Application<a class="hash-link" href="#stream-application" title="Direct link to heading">​</a></h2><p>The processing logic for your program can be written using the Streaming SQL and put together as a single declarative spec called as the <code>Stream Application</code> or the <code>StreamApp</code>.</p><p>StreamApps are named by adding <code>@app:name(&#x27;&lt;name&gt;&#x27;)</code> annotation on the top of the StreamApp spec. When the annotation is not added stream processor assigns a random UUID as the name of the StreamApp.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="purpose">Purpose<a class="hash-link" href="#purpose" title="Direct link to heading">​</a></h3><p>StreamApp provides an isolated execution environment for your processing logic that allows you to deploy and execute processing logic independent of other StreamApps in the system. Therefore it&#x27;s always recommended to have a processing logic related to single use case in a single StreamApp. This will help you to group processing logic and easily manage addition and removal of various use cases.</p><p>The following diagram depicts some of the key Stream QL elements of Stream Application and how <strong>event flows</strong> through the elements.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>&quot;Have different business use cases in separate Stream Applications.&quot;
This is recommended as it allows users to selectively deploy the applications based their on business needs. It is also recommended to move the repeated steam processing logic that exist in multiple Stream Applications such as message retrieval and preprocessing, to a common Stream Application, whereby reducing code duplication and improving maintainability. In this case, to pass the events from one Stream App to another, configure them using a common stream or collection using <code>stream</code> Sink and <code>stream</code> Source.</p></div></div><p><img loading="lazy" alt="Event Flow" src="/docs/assets/images/event-flow-e8b52d8c8b1d8e03215a1454e6684652.png" title="Event Flow" width="1200" height="655" class="img_E7b_"></p><p>Below table provides brief description of a few key elements in the Stream QL Language.</p><table><thead><tr><th>Elements</th><th>Description</th></tr></thead><tbody><tr><td>Stream</td><td>A logical series of events ordered in time with a uniquely identifiable name, and a defined set of typed attributes defining its schema.</td></tr><tr><td>Event</td><td>An event is a single event object associated with a stream. All events of a stream contains a timestamp and an identical set of typed attributes based on the schema of the stream they belong to.</td></tr><tr><td>Table</td><td>A structured representation of data stored with a defined schema. Stored data is backed by C8DB. The tables (aka collections) can be <code>local</code> or <code>geo-replicated</code>. Similarly the tables can be <code>document</code> or <code>graph</code> collections. The tables can be accessed and manipulated at runtime.</td></tr><tr><td>Named Window</td><td>A structured representation of data stored with a defined schema and eviction policy. Window data is stored <code>In-Memory</code> and automatically cleared by the named window constrain. Other stream processor elements can only query the values in windows at runtime but they cannot modify them.</td></tr><tr><td>Named Aggregation</td><td>A structured representation of data that&#x27;s incrementally aggregated and stored with a defined schema and aggregation granularity such as seconds, minutes, hours, etc. Aggregation data is stored in <code>database</code>. Other stream processor elements can only query the values in windows at runtime but they cannot modify them.</td></tr><tr><td>Query</td><td>A logical construct that processes events in streaming manner by by consuming data from one or more streams, tables, windows and aggregations, and publishes output events into a stream, table or a window.</td></tr><tr><td>Source</td><td>A construct that consumes data from external sources (such as <code>database</code>, <code>stream</code>, <code>TCP</code>, <code>Kafka</code>, <code>HTTP</code>, etc) with various event formats such as <code>XML</code>, <code>JSON</code>, <code>binary</code>, etc, convert then to stream events, and passes into streams for processing.</td></tr><tr><td>Sink</td><td>A construct that consumes events arriving at a stream, maps them to a predefined data format (such as <code>XML</code>, <code>JSON</code>, <code>binary</code>, etc), and publishes them to external endpoints (such as <code>E-mail</code>, <code>TCP</code>, <code>Kafka</code>, <code>HTTP</code>, etc).</td></tr><tr><td>Stream/Query Callback</td><td>A mechanism to programmatically consume output events from streams or queries.</td></tr><tr><td>Partition</td><td>A logical container that isolates the processing of queries based on the partition keys derived from the events.</td></tr><tr><td>Inner Stream</td><td>A positionable stream that connects portioned queries with each other within the partition.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_mojV" id="syntax">Syntax<a class="hash-link" href="#syntax" title="Direct link to heading">​</a></h4><p>StreamApp is a collection of Stream QL elements composed together as a script. Here each stream query element must be separated by a semicolon <code>;</code>.</p><p>High level syntax of StreamApp is as follows.</p><div class="language-js codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-js codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">stream app</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">app annotation</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">stream definition</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">table definition</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">query</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">partition</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, this stream application with name <code>Temperature-Analytics</code> creates a stream named <code>TempStream</code> and a query named <code>5minAvgQuery</code>.</p><div class="language-js codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-js codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">@app</span><span class="token operator" style="color:#393A34">:</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Temperature-Analytics&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token maybe-class-name">App</span><span class="token operator" style="color:#393A34">:</span><span class="token function" style="color:#d73a49">qlVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">CREATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">STREAM</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">TempStream</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deviceID long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomNo int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temp double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;5minAvgQuery&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into </span><span class="token maybe-class-name">OutputStream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">avg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token maybe-class-name">TempStream</span><span class="token plain">#</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="stream">Stream<a class="hash-link" href="#stream" title="Direct link to heading">​</a></h2><p>A stream is a logical series of events ordered in time. Its schema is defined via the <em>stream definition</em>. A stream definition contains the stream name and a set of attributes with specific types and uniquely identifiable names within the stream. All events associated to the stream will have the same schema (i.e., have the same attributes in the same order).</p><p>Stream processor groups common types of events together with a schema. This helps in various ways such as, processing all events together in queries and performing data format transformations together when they are consumed and published via sources and sinks.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="syntax-1">Syntax<a class="hash-link" href="#syntax-1" title="Direct link to heading">​</a></h3><p>The syntax for defining a new stream is as follows.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> STREAM </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">stream_name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute_name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute_name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are used to configure a stream definition.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>stream name</code></td><td>The name of the stream created. (It is recommended to define a stream name in <code>PascalCase</code>.)</td></tr><tr><td><code>attribute name</code></td><td>Uniquely identifiable name of the stream attribute. (It is recommended to define attribute names in <code>camelCase</code>.)</td></tr><tr><td><code>attribute type</code></td><td>The type of each attribute defined in the schema.  This can be <code>STRING</code>, <code>INT</code>, <code>LONG</code>, <code>DOUBLE</code>, <code>FLOAT</code>, <code>BOOL</code> or <code>OBJECT</code>.</td></tr></tbody></table><p>To use and refer stream and attribute names that do not follow <code>[a-zA-Z_][a-zA-Z_0-9]*</code> format enclose them in <code>`</code>. E.g. <code>`$test(0)`</code>.</p><p>To make the stream process events with multi-threading and asynchronously, we add <code>Async</code> to the <code>WITH()</code> property. For example: <code>WITH(async=&#x27;true&#x27;)</code></p><p>This example creates a stream called <code>TempStream</code> with the following attributes:</p><ul><li><code>deviceID</code> of type <code>long</code></li><li><code>roomNo</code> of type <code>int</code></li><li><code>temp</code> of type <code>double</code></li></ul><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> STREAM TempStream </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deviceID long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomNo </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="source">Source<a class="hash-link" href="#source" title="Direct link to heading">​</a></h3><p>Sources receive events via multiple transports and in various data formats, and direct them into streams for processing.</p><p>A source configuration allows to define a mapping in order to convert each incoming event from its native data format to a stream event. When customizations to such mappings are not provided, stream processor assumes that the arriving event adheres to the predefined format based on the stream definition and the configured message mapping type.</p><p><strong>Purpose</strong></p><p>Source provides a way to consume events from internal &amp; external services and convert them to be processed by the associated stream.</p><p><strong>Syntax</strong></p><p>To configure a stream that consumes events via a source, add the source configuration to a stream definition by adding the <code>source.type</code> annotation with the required parameter values.</p><p>The source syntax is as follows:</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> SOURCE </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">source_name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;source_type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">static_key</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token string" style="color:#e3116c">&#x27;&lt;value&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute1</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token string" style="color:#e3116c">&#x27;&lt;attribute mapping&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute2</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token string" style="color:#e3116c">&#x27;&lt;attribute mapping&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This syntax includes the following annotations.</p><p><strong>Source</strong></p><p>The <code>type</code> parameter of <code>CREATE SOURCE</code> annotation defines the source type that receives events. The other parameters of <code>source.type</code> annotation depends upon the selected source type, and here some of its parameters can be optional.</p><p>The following is the list of source types supported by Stream:</p><table><thead><tr><th>Source type</th><th>Description</th></tr></thead><tbody><tr><td><code>database</code></td><td>Allow stream app to consume events from collections (doc, graphs) running in the same or different geo fabric.</td></tr><tr><td><code>stream</code></td><td>Allow stream app to consume events from streams (local, geo-replicated) running in the same or different geo fabric.</td></tr><tr><td><code>Kafka</code></td><td>Subscribe to Kafka topic to consume events.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_mojV" id="source-mapper">Source Mapper<a class="hash-link" href="#source-mapper" title="Direct link to heading">​</a></h4><p>Each <code>source.type</code> configuration can have a mapping denoted by the <code>map.type</code> annotation that defines how to convert the incoming event format to Stream events.</p><p>The <code>type</code> parameter of the <code>map.type</code> defines the map type to be used in converting the incoming events. The other parameters of <code>map.type</code> annotation depends on the mapper selected, and some of its parameters can be optional.</p><p>For detailed information about the parameters see the documentation of the relevant mapper.</p><p><strong>Map Attributes</strong></p><p><code>attributes</code> is an optional annotation used with <code>map.type</code> to define custom mapping. When <code>attributes</code> is not provided, each mapper assumes that the incoming events adheres to its own default message format and attempt to convert the events from that format. By adding the <code>attributes</code> annotation, users can selectively extract data from the incoming message and assign them to the attributes.</p><p>There are two ways to configure <code>attributes</code>. In both cases, add the attributes in parentheses after the query:</p><ul><li><p>Define attribute names as keys, and mapping configurations as values:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">... ( &lt;attribute1&gt;=&#x27;&lt;mapping&gt;&#x27;, &lt;attributeN&gt;=&#x27;&lt;mapping&gt;&#x27;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Define the mapping configurations in the same order as the attributes defined in stream definition:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">... ( &#x27;&lt;mapping for attribute1&gt;&#x27;, &#x27;&lt;mapping for attributeN&gt;&#x27;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p><strong>Supported Source Mapping Types</strong></p><p>The following is the list of source mapping types supported by Stream:</p><table><thead><tr><th>Source mapping type</th><th>Description</th></tr></thead><tbody><tr><td>PassThrough</td><td>Omits data conversion on Stream events.</td></tr><tr><td>JSON</td><td>Converts JSON messages to Stream events.</td></tr><tr><td>XML</td><td>Converts XML messages to Stream events.</td></tr><tr><td>TEXT</td><td>Converts plain text messages to Stream events.</td></tr><tr><td>Key Value</td><td>Converts key-value HashMaps to Stream events.</td></tr><tr><td>CSV</td><td>Converts CSV like delimiter separated events to Stream events.</td></tr></tbody></table><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>When the <code>map.type</code> annotation is not provided <code>map.type=&#x27;passThrough&#x27;</code> is used as default, that passes the consumed stream events directly to the streams without any data conversion.</p></div></div><p><strong>Example 1</strong></p><p>Receive <code>JSON</code> messages via <code>stream</code>, and direct them to <code>InputStream</code> stream for processing. The stream expects the <code>JSON</code> messages to be on the default data format that&#x27;s supported by the <code>JSON</code> mapper as follows.</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Paul&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;age&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;UK&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The configuration of the <code>stream</code> source and <code>JSON</code> source mapper to achieve the above is as follows.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> SOURCE InputStream </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;stream&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> streams</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> age </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> country string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong></p><p>Receive <code>JSON</code> messages via <code>database</code>, and direct them to <code>StockStream</code> stream for processing. Here the incoming <code>JSON</code>, as given below, do not adhere to the default data format that&#x27;s supported by the <code>JSON</code> mapper.</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;portfolio&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;stock&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;volume&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;company&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;symbol&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;FB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">55.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The configuration of the <code>database</code> source and the custom <code>JSON</code> source mapping to achieve the above is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SOURCE StockStream WITH (source.type=&#x27;database&#x27;, collection=&#x27;foo&#x27;, map.type=&#x27;json&#x27;, enclosing.element=&quot;$.portfolio&quot;,) (symbol = &quot;stock.company.symbol&quot;, price = &quot;stock.price&quot;, volume = &quot;stock.volume&quot;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The same can also be configured by omitting the attribute names as below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SOURCE StockStream WITH (source.type=&#x27;database&#x27;, collection=&#x27;foo&#x27;, map.type=&#x27;json&#x27;, enclosing.element=&quot;$.portfolio&quot;,) (&quot;stock.company.symbol&quot;, &quot;stock.price&quot;, &quot;stock.volume&quot;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="sink">Sink<a class="hash-link" href="#sink" title="Direct link to heading">​</a></h3><p>Sinks consumes events from streams and publish them via multiple transports to external endpoints in various data formats.</p><p>A sink configuration allows users to define a mapping to convert the Stream events in to the required output data format (such as <code>JSON</code>, <code>TEXT</code>, <code>XML</code>, etc.) and publish the events to the configured endpoints. When customizations to such mappings are not provided, Stream converts events to the predefined event format based on the stream definition and the configured message mapper type before publishing the events.</p><p><strong>Purpose</strong></p><p>Sink provides a way to publish stream events of a stream to external systems by converting events to their supported format.</p><p><strong>Syntax</strong></p><p>To configure a stream to publish events via a sink, add the sink configuration to a stream definition by adding the <code>sink.type</code> annotation with the required parameter values.</p><p>The sink syntax is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK &lt;stream name&gt; WITH (sink.type=&#x27;&lt;sink type&gt;&#x27;, &lt;static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.type=&#x27;&lt;map type&gt;&#x27;, &lt;static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.payload&#x27;&lt;payload mapping&gt;&#x27;)) (&lt;attribute1&gt; &lt;type&gt;, &lt;attributeN&gt; &lt;type&gt;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>&quot;Dynamic Properties&quot;
The sink and sink mapper properties that are categorized as <code>dynamic</code> have the ability to absorb attribute values
dynamically from the Stream events of their associated streams. This can be configured by enclosing the relevant
attribute names in double curly braces as<code>{{...}}</code>, and using it within the property values.</p><p>Some valid dynamic properties values are:</p><ul><li><code>&#x27;{{attribute1}}&#x27;</code></li><li><code>&#x27;This is {{attribute1}}&#x27;</code></li><li><code>{{attribute1}} &gt; {{attributeN}}</code>  </li></ul><p>Here the attribute names in the double curly braces will be replaced with the values from the events before they are published.</p></div></div><p>This syntax includes the following annotations.</p><p><strong>Sink</strong></p><p>The <code>type</code> parameter of the <code>sink.type</code> annotation defines the sink type that publishes the events. The other parameters of the <code>sink.type</code> annotation depends upon the selected sink type, and here some of its parameters can be optional and/or dynamic.</p><p>The following is a list of sink types supported by stream processor:</p><table><thead><tr><th>Source type</th><th>Description</th></tr></thead><tbody><tr><td>database</td><td>Allow StreamApp to publish events to collections (doc, graphs) in the same or different geofabric.</td></tr><tr><td>HTTP</td><td>Publish events to an HTTP endpoint.</td></tr><tr><td>Kafka</td><td>Publish events to Kafka topic.</td></tr><tr><td>TCP</td><td>Publish events to a TCP service.</td></tr><tr><td>Email</td><td>Send emails via SMTP protocols.</td></tr><tr><td>Web Socket</td><td>Publish events to a Web Socket</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_mojV" id="distributed-sink">Distributed Sink<a class="hash-link" href="#distributed-sink" title="Direct link to heading">​</a></h4><p>Distributed Sinks publish events from a defined stream to multiple endpoints using load balancing or partitioning strategies.</p><p>Any sink can be used as a distributed sink. A distributed sink configuration allows users to define a common mapping to convert
and send the Stream events for all its destination endpoints.</p><p><strong>Purpose</strong></p><p>Distributed sink provides a way to publish Stream events to multiple endpoints in the configured event format.</p><p><strong>Syntax</strong></p><p>To configure distributed sink add the sink configuration to a stream definition by adding the <code>sink.type</code> property and add the configuration parameters that are common of all the destination endpoints inside it, along with the common parameters also add the <code>distribution.strategy</code> property specifying the distribution strategy (i.e. <code>roundRobin</code> or <code>partitioned</code>) and <code>destination</code> properties providing each endpoint specific configurations.</p><p>The distributed sink syntax is as follows:</p><p><strong><em>RoundRobin Distributed Sink</em></strong></p><p>Publishes events to defined destinations in a round robin manner.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK &lt;stream name&gt; WITH (sink.type=&#x27;&lt;sink type&gt;&#x27;, &lt;common.static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;common.dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.type=&#x27;&lt;map type&gt;&#x27;, &lt;static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.payload=&#x27;&lt;payload mapping&gt;&#x27; distribution.strategy=&#x27;roundRobin&#x27;, destination.&lt;key&gt;=&#x27;&lt;value&gt;&#x27;, destination.&lt;key&gt;=&#x27;&lt;value&gt;&#x27;) (&lt;attribute1&gt; &lt;type&gt;, &lt;attributeN&gt; &lt;type&gt;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong><em>Partitioned Distributed Sink</em></strong></p><p>Publishes events to defined destinations by partitioning them based on the partitioning key.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK &lt;stream name&gt; WITH (sink.type=&#x27;&lt;sink type&gt;&#x27;, &lt;common.static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;common.dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.type=&#x27;&lt;map type&gt;&#x27;, &lt;static.key&gt;=&#x27;&lt;value&gt;&#x27;, &lt;dynamic.key&gt;=&#x27;{{&lt;value&gt;}}&#x27;, map.payload=&#x27;&lt;payload mapping&gt;&#x27;, distribution.strategy=&#x27;partitioned&#x27;, partitionKey=&#x27;&lt;partition key&gt;&#x27;, destination.&lt;key&gt;=&#x27;&lt;value&gt;&#x27;, destination.&lt;key&gt;=&#x27;&lt;value&gt;&#x27;) (&lt;attribute1&gt; &lt;type&gt;, &lt;attributeN&gt; &lt;type&gt;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="sink-mapper">Sink Mapper<a class="hash-link" href="#sink-mapper" title="Direct link to heading">​</a></h4><p>Each <code>sink.type</code> configuration can have a mapping denoted by the <code>map.type</code> annotation that defines how to convert Stream events to outgoing messages with the defined format.</p><p>The <code>type</code> parameter of the <code>map.type</code> defines the map type to be used in converting the outgoing events. The other parameters of <code>map.type</code> annotation depends on the mapper selected, and some of its parameters can be optional and/or dynamic.</p><p>For detailed information about the parameters see the documentation of the relevant mapper.</p><p><strong>Map Payload</strong></p><p><code>map.payload</code> is an optional annotation used with <code>map.type</code> to define custom mapping. When the <code>map.payload</code> annotation is not provided, each mapper maps the outgoing events to its own default event format. The <code>map.payload</code> annotation allow users to configure mappers to produce the output payload of their choice, and by using dynamic properties within the payload they can selectively extract and add data from the published Stream events.</p><p>There are two ways you to configure <code>map.payload</code> annotation.</p><ol><li>Some mappers such as <code>XML</code>, <code>JSON</code>, and <code>Test</code> only accept one output payload: <div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">map.payload=&#x27;This is a test message from {{user}}.&#x27;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Some mappers such <code>key-value</code> accept series of mapping values: <div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">map.payload= key1=&#x27;mapping_1&#x27;, &#x27;key2&#x27;=&#x27;user : {{user}}&#x27;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>Here, the keys of payload mapping can be defined using the dot notation as <code>a.b.c</code>, or using any constant string value as <code>&#x27;$abc&#x27;</code>.</li></ol><p><strong>Supported Sink Mapping Types</strong></p><p>The following is a list of sink mapping types supported by Stream:</p><table><thead><tr><th>Sink mapping type</th><th>Description</th></tr></thead><tbody><tr><td>PassThrough</td><td>Omits data conversion on Stream events.</td></tr><tr><td>JSON</td><td>Converts JSON messages to Stream events.</td></tr><tr><td>XML</td><td>Converts XML messages to Stream events.</td></tr><tr><td>TEXT</td><td>Converts plain text messages to Stream events.</td></tr><tr><td>Key Value</td><td>Converts key-value HashMaps to Stream events.</td></tr><tr><td>CSV</td><td>Converts CSV like delimiter separated events to Stream events.</td></tr></tbody></table><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>When the <code>map.type</code> annotation is not provided <code>map.type=&#x27;passThrough&#x27;</code> is used as default, that passes the outgoing Stream events directly to the sinks without any data conversion.</p></div></div><p><strong>Example 1</strong></p><p>Publishes <code>OutputStream</code> events by converting them to <code>JSON</code> messages with the default format, and by sending to an <code>HTTP</code> endpoint <code>http://localhost:8005/endpoint1</code>, using <code>POST</code> method, <code>Accept</code> header, and basic authentication having <code>admin</code> is both username and password.</p><p>The configuration of the <code>HTTP</code> sink and <code>JSON</code> sink mapper to achieve the above is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK OutputStream WITH (sink.type=&#x27;http&#x27;, publisher.url=&#x27;http://localhost:8005/endpoint&#x27;, method=&#x27;POST&#x27;, headers=&#x27;Accept-Date:20/02/2017&#x27;, basic.auth.enabled=&#x27;true&#x27;, basic.auth.username=&#x27;admin&#x27;, basic.auth.password=&#x27;admin&#x27;, map.type=&#x27;json&#x27;) (name string, age int, country string);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will publish a <code>JSON</code> message on the following format:</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;event&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Paul&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;age&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;UK&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong></p><p>Publishes <code>StockStream</code> events by converting them to user defined <code>JSON</code> messages, and by sending to an <code>HTTP</code> endpoint <code>http://localhost:8005/stocks</code>.</p><p>The configuration of the <code>HTTP</code> sink and custom <code>JSON</code> sink mapping to achieve the above is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK StockStream WITH (sink.type=&#x27;http&#x27;, publisher.url=&#x27;http://localhost:8005/stocks&#x27;, map.type=&#x27;json&#x27;, validate.json=&#x27;true&#x27;, enclosing.element=&#x27;$.Portfolio&#x27;, map.payload=&quot;&quot;&quot;{&quot;StockData&quot;:{ &quot;Symbol&quot;:&quot;{{symbol}}&quot;, &quot;Price&quot;:{{price}} }}&quot;&quot;&quot;) (symbol string, price float, volume long);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will publish a single event as the <code>JSON</code> message on the following format:</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Portfolio&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;StockData&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Symbol&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;GOOG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">55.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can also publish multiple events together as a <code>JSON</code> message on the following format:</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Portfolio&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;StockData&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Symbol&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;GOOG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">55.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;StockData&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Symbol&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;FB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">57.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 3</strong></p><p>Publishes events from the <code>OutputStream</code> stream to multiple the <code>HTTP</code> endpoints using a partitioning strategy. Here the events are sent to either <code>http://localhost:8005/endpoint1</code> or <code>http://localhost:8006/endpoint2</code> based on the partitioning key <code>country</code>. It uses default <code>JSON</code> mapping, <code>POST</code> method, and used <code>admin</code> as both the username and the password when publishing to both the endpoints.</p><p>The configuration of the distributed <code>HTTP</code> sink and <code>JSON</code> sink mapper to achieve the above is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK OutputStream WITH (sink.type=&#x27;http&#x27;, method=&#x27;POST&#x27;, basic.auth.enabled=&#x27;true&#x27;, basic.auth.username=&#x27;admin&#x27;, basic.auth.password=&#x27;admin&#x27;, map.type=&#x27;json&#x27;, distribution.strategy=&#x27;partitioned&#x27;, partitionKey=&#x27;country&#x27;, destination.publisher.url=&#x27;http://localhost:8005/endpoint1&#x27;, destination.publisher.url=&#x27;http://localhost:8006/endpoint2&#x27;) (name string, age int, country string);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will partition the outgoing events and publish all events with the same country attribute value to the same endpoint. The <code>JSON</code> message published will be on the following format:</p><div class="language-json codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-json codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;event&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Paul&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;age&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;UK&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="error-handling">Error Handling<a class="hash-link" href="#error-handling" title="Direct link to heading">​</a></h3><p>Errors in Stream can be handled at the Streams and in Sinks.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="error-handling-at-stream">Error Handling at Stream<a class="hash-link" href="#error-handling-at-stream" title="Direct link to heading">​</a></h4><p>When errors are thrown by Stream elements subscribed to the stream, the error gets propagated up to the stream that delivered the event to those Stream elements. By default the error is logged and dropped at the stream, but this behavior can be altered by by adding <code>OnError</code> property to the corresponding stream definition.</p><p><code>OnError</code> property can help users to capture the error and the associated event, and handle them gracefully by sending them to a fault stream.</p><p>The <code>OnError</code> property and the required <code>action</code> to be specified as below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SOURCE &lt;stream name&gt; WITH (OnError.action=&#x27;&lt;action&gt;&#x27;) (&lt;attribute name&gt; &lt;attribute type&gt;, &lt;attribute name&gt; &lt;attribute type&gt;, ... );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>action</code> parameter of the <code>OnError</code> property defines the action to be executed during failure scenarios.</p><p>The following actions can be specified to <code>OnError</code> property to handle erroneous scenarios.</p><ul><li><code>STREAM</code>: Creates a fault stream and redirects the event and the error to it. The created fault stream will have all the attributes defined in the base stream to capture the error causing event, and in addition it also contains <code>_error</code> attribute of type <code>object</code> to containing the error information. The fault stream can be referred by adding <code>!</code> in front of the base stream name as <code>!&lt;stream name&gt;</code>.</li></ul><p><strong>Example</strong></p><p>Handle errors in <code>TempStream</code> by redirecting the errors to a fault stream.</p><p>The configuration of <code>TempStream</code> stream and <code>OnError</code> property is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream WITH(OnError.action=&quot;STREAM&quot;) (deviceID long, roomNo int, temp double;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Stream infers and automatically defines the fault stream of <code>TempStream</code> as given below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM !TempStream (deviceID long, roomNo int, temp double, _error object);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The StreamApp extending the above the use-case by adding failure generation and error handling with the use of <a href="#query">queries</a> is as follows.</p><p>Note: Details on writing processing logics via <a href="#query">queries</a> will be explained in later sections.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">-- Define fault stream to handle error occurred at TempStream subscribers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream WITH(OnError.action=&quot;STREAM&quot;) (deviceID long, roomNo int, temp double;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Error generation through a custom function `createError()`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@name(&#x27;error-generation&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into IgnoreStream1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#custom:createError();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Handling error by simply logging the event and error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@name(&#x27;handle-error&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into IgnoreStream2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select deviceID, roomNo, temp, _error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from !TempStream#log(&quot;Error Occurred!&quot;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="error-handling-at-sink">Error Handling at Sink<a class="hash-link" href="#error-handling-at-sink" title="Direct link to heading">​</a></h4><p>There can be cases where external systems becoming unavailable or coursing errors when the events are published to them. By default sinks log and drop the events causing event losses, and this can be handled gracefully by configuring <code>on.error</code> parameter of the <code>sink.type</code> annotation.</p><p>The <code>on.error</code> parameter of the <code>sink.type</code> annotation can be specified as below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK &lt;stream name&gt; WITH (sink.type=&#x27;&lt;sink type&gt;&#x27;, on.error.action=&#x27;&lt;on error action&gt;&#x27;, &lt;key&gt;=&#x27;&lt;value&gt;&#x27;, ...) (&lt;attribute name&gt; &lt;attribute type&gt;, &lt;attribute name&gt; &lt;attribute type&gt;, ... );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following actions can be specified to <code>on.error</code> parameter of <code>sink.type</code> annotation to handle erroneous scenarios.</p><ul><li><p><code>WAIT</code> : Publishing threads wait in <code>back-off and re-trying</code> mode, and only send the events when the connection is re-established. During this time the threads will not consume any new messages causing the systems to introduce back pressure on the systems that publishes to it.</p></li><li><p><code>STREAM</code>: Pushes the failed events with the corresponding error to the associated fault stream the sink belongs to.</p></li></ul><p><strong>Example 1</strong></p><p>Introduce back pressure on the threads who bring events via <code>TempStream</code> when the system cannot connect to Kafka.</p><p>The configuration of <code>TempStream</code> stream and <code>sink.type</code> Kafka annotation with <code>on.error</code> property is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK TempStream WITH (sink.type=&#x27;kafka&#x27;, on.error.action=&#x27;WAIT&#x27;, topic=&#x27;{{roomNo}}&#x27;, bootstrap.servers=&#x27;localhost:9092&#x27;, map.type=&#x27;xml&#x27;) (deviceID long, roomNo int, temp double);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong></p><p>Send events to the fault stream of <code>TempStream</code> when the system cannot connect to Kafka.</p><p>The configuration of <code>TempStream</code> stream with associated fault stream, <code>sink.type</code> Kafka annotation with <code>on.error</code> property and a <a href="#query">queries</a> to handle the error is as follows.</p><p>Note: Details on writing processing logics via <a href="#query">queries</a> will be explained in later sections.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE SINK TempStream WITH (sink.type=&#x27;kafka&#x27;, on.error.action=&#x27;STREAM&#x27;, topic=&#x27;{{roomNo}}&#x27;, bootstrap.servers=&#x27;localhost:9092&#x27;, map.type=&#x27;xml&#x27;) (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Handling error by simply logging the event and error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@name(&#x27;handle-error&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into IgnoreStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select deviceID, roomNo, temp, _error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from !TempStream#log(&quot;Error Occurred!&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="query">Query<a class="hash-link" href="#query" title="Direct link to heading">​</a></h2><p>Query defines the processing logic in Stream. It consumes events from one or more streams, <a href="#named-window">named-windows</a>, <a href="#table">tables</a>, and/or <a href="#named-aggregation">named-aggregations</a>, process the events in a streaming manner, and generate output events into a <a href="#stream">stream</a>, <a href="#named-window">named-window</a>, or <a href="#table">table</a>.</p><p><strong>Purpose</strong></p><p>A query provides a way to process the events in the order they arrive and produce output using both stateful and stateless complex event processing and stream processing operations.</p><p><strong>Syntax</strong></p><p>The high level query syntax for defining processing logics is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">@name(&#x27;&lt;query name&gt;&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;output action&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;projection&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are used to configure a stream definition.</p><table><thead><tr><th>Parameter<!-- --> <!-- --> <!-- --> <!-- --> </th><th>Description</th></tr></thead><tbody><tr><td><code>query name</code></td><td>The name of the query. Since naming the query (i.e the <code>@name(&#x27;&lt;query name&gt;&#x27;)</code> annotation) is optional, when the name is not provided Stream assign a system generated name for the query.</td></tr><tr><td><code>input</code></td><td>Defines the means of event consumption via <a href="#stream">streams</a>, <a href="#named-window">named-windows</a>, <a href="#table">tables</a>, and/or <a href="#named-aggregations">named-aggregations</a>, and defines the processing logic using <a href="#filter">filters</a>, <a href="#window">windows</a>, <a href="#stream-function">stream-functions</a>, <a href="#join">joins</a>, <a href="#pattern">patterns</a> and <a href="#sequence">sequences</a>.</td></tr><tr><td><code>projection</code></td><td>Generates output event attributes using <a href="#select">select</a>, <a href="#function">functions</a>, <a href="#aggregation-function">aggregation-functions</a>, and <a href="#group-by">group by</a> operations, and filters the generated the output using <a href="#having">having</a>, <a href="#limit-offset">limit &amp; offset</a>, <a href="#order-by">order by</a>, and <a href="#output-rate-limiting">output rate limiting</a> operations before sending them out. Here the projection is optional and when it is omitted all the input events will be sent to the output as it is.</td></tr><tr><td><code>output action</code></td><td>Defines output action (such as <code>insert into</code>, <code>update</code>, <code>delete</code>, etc) that needs to be performed by the generated events on a <a href="#stream">stream</a>, <a href="#named-window">named-window</a>, or <a href="#table">table</a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h3><p>A query consumes events from the <code>TempStream</code> stream and output only the <code>roomNo</code> and <code>temp</code> attributes to the <code>RoomTempStream</code> stream, from which another query consumes the events and sends all its attributes to <code>AnotherRoomTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into RoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AnotherRoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from RoomTempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>&quot;Inferred Stream&quot;</h5></div><div class="admonition-content"><p>Here, the <code>RoomTempStream</code> and <code>AnotherRoomTempStream</code> streams are an inferred streams, which means their stream definitions are inferred from the queries and they can be used same as any other defined stream without any restrictions.  </p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="value">Value<a class="hash-link" href="#value" title="Direct link to heading">​</a></h3><p>Values are typed data, that can be manipulated, transferred and stored. Values can be referred by the attributes defined in definitions such as streams, and tables.</p><p>Stream supports values of type <code>STRING</code>, <code>INT</code> (Integer), <code>LONG</code>, <code>DOUBLE</code>, <code>FLOAT</code>, <code>BOOL</code> (Boolean) and <code>OBJECT</code>.</p><p>The syntax of each type and their example use as a constant value is as follows,</p><table style="width:100%"><tr><th style="width:10%">Attribute Type</th><th style="width:50%">Format</th><th style="width:40%">Example</th></tr><tr><td>int</td><td>`&amp;ltdigit&amp;gt+`</td><td>`123`, `-75`, `+95`</td></tr><tr><td>long</td><td>`&amp;ltdigit&amp;gt+L`</td><td>`123000L`, `-750l`, `+154L`</td></tr><tr><td>float</td><td>`(&amp;ltdigit&amp;gt+)?(&#x27;.&#x27;&amp;ltdigit&amp;gt*)?(E(-|+)?&amp;ltdigit&amp;gt+)?F`</td><td>`123.0f`, `-75.0e-10F`,`+95.789f`</td></tr><tr><td>double</td><td>`(&amp;ltdigit&amp;gt+)?(&#x27;.&#x27;&amp;ltdigit&amp;gt*)?(E(-|+)?&amp;ltdigit&amp;gt+)?D?`</td><td>`123.0`,`123.0D`,`-75.0e-10D`,`+95.789d`</td></tr><tr><td>bool</td><td>`(true|false)`</td><td>`true`, `false`, `TRUE`, `FALSE`</td></tr><tr><td>string</td><td>`&#x27;(&lt;char&gt;* !(&#x27;|&quot;|&quot;&quot;&quot;|&amp;ltnew line&amp;gt))&#x27;` or  `&quot;(&lt;char&gt;* !(&quot;|&quot;&quot;&quot;|&amp;ltnew line&amp;gt))&quot;` or `&quot;&quot;&quot;(&lt;char&gt;* !(&quot;&quot;&quot;))&quot;&quot;&quot;` </td><td>`&#x27;Any text.&#x27;`, `&quot;Text with &#x27;single&#x27; quotes.&quot;`, <div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;&quot;&quot; Text with &#x27;single&#x27; quotes, &quot;double&quot; quotes, and new lines. &quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></td></tr></table><p><strong><em>Time</em></strong></p><p>Time is a special type of <code>LONG</code> value that denotes time using digits and their unit in the format <code>(&lt;digit&gt;+ &lt;unit&gt;)+</code>. At execution, the <code>time</code> gets converted into <strong>milliseconds</strong> and returns a <code>LONG</code> value.</p><table style="width:100%"><tr><th>Unit</th><th>Syntax</th></tr><tr><td>Year</td><td>`year` | `years`</td></tr><tr><td>Month</td><td>`month` | `months`</td></tr><tr><td>Week</td><td>`week` | `weeks`</td></tr><tr><td>Day</td><td>`day` | `days`</td></tr><tr><td>Hour</td><td>`hour` | `hours`</td></tr><tr><td>Minutes</td><td>`minute` | `minutes` | `min`</td></tr><tr><td>Seconds</td><td>`second` | `seconds` | `sec`</td></tr><tr><td>Milliseconds</td><td>`millisecond` | `milliseconds`</td></tr></table><p><strong>Example</strong></p><p>1 hour and 25 minutes can by written as <code>1 hour and 25 minutes</code> which is equal to the <code>LONG</code> value <code>5100000</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="select">Select<a class="hash-link" href="#select" title="Direct link to heading">​</a></h3><p>The select clause in stream query defines the output event attributes of the query. Following are some basic query projection operations supported by select.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="function">Function<a class="hash-link" href="#function" title="Direct link to heading">​</a></h3><p>Functions are pre-configured operations that can consumes zero, or more parameters and always produce a single value as result. It can be used anywhere an attribute can be used.</p><p><strong>Purpose</strong></p><p>Functions encapsulate pre-configured reusable execution logic allowing users to execute the logic anywhere just by calling the function. This also make writing StreamApps simple and easy to understand.</p><p><strong>Syntax</strong></p><p>The syntax of function is as follows,</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">parameter</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here <code>&lt;function name&gt;</code> uniquely identifies the function. The <code>&lt;parameter&gt;</code> defined input parameters the function can accept. The input parameters can be attributes, constant values, results of other functions, results of mathematical or logical expressions, or time values. The number and type of parameters a function accepts depend on the function itself.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Functions, mathematical expressions, and logical expressions can be used in a nested manner.</p></div></div><p><strong>Example 1</strong></p><p>Function name <code>add</code> accepting two input parameters, is called with an attribute named <code>input</code> and a constant value <code>75</code>.  </p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">add(input, 75)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong></p><p>Function name <code>alertAfter</code> accepting two input parameters, is called with a time value of <code>1 hour and 25 minutes</code> and a mathematical addition operation of <code>startTime</code> + <code>56</code>.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">add(1 hour and 25 minutes, startTime + 56)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Inbuilt functions</strong></p><p>Following are some inbuilt Stream functions, for more functions refer <a href="/docs/cep/reference/functions">Functions</a>.</p><table><thead><tr><th>Inbuilt function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/reference/functions#eventtimestamp-function">eventTimestamp</a></td><td>Returns event&#x27;s timestamp.</td></tr><tr><td><a href="/docs/cep/reference/functions#currenttimemillis-function">currentTimeMillis</a></td><td>Returns current time of StreamApp runtime.</td></tr><tr><td><a href="/docs/cep/reference/functions#default-function">default</a></td><td>Returns a default value if the parameter is null.</td></tr><tr><td><a href="/docs/cep/reference/functions#ifthenelse-function">ifThenElse</a></td><td>Returns parameters based on a conditional parameter.</td></tr><tr><td><a href="/docs/cep/reference/functions#uuid-function">UUID</a></td><td>Generates a UUID.</td></tr><tr><td><a href="/docs/cep/reference/functions#cast-function">cast</a></td><td>Casts parameter type.</td></tr><tr><td><a href="/docs/cep/reference/functions#convert-function">convert</a></td><td>Converts parameter type.</td></tr><tr><td><a href="/docs/cep/reference/functions#coalesce-function">coalesce</a></td><td>Returns first not null input parameter.</td></tr><tr><td><a href="/docs/cep/reference/functions#maximum-function">maximum</a></td><td>Returns the maximum value of all parameters.</td></tr><tr><td><a href="/docs/cep/reference/functions#minimum-function">minimum</a></td><td>Returns the minimum value of all parameters.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceofboolean-function">instanceOfBoolean</a></td><td>Checks if the parameter is an instance of Boolean.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceofdouble-function">instanceOfDouble</a></td><td>Checks if the parameter is an instance of Double.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceoffloat-function">instanceOfFloat</a></td><td>Checks if the parameter is an instance of Float.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceofinteger-function">instanceOfInteger</a></td><td>Checks if the parameter is an instance of Integer.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceoflong-function">instanceOfLong</a></td><td>Checks if the parameter is an instance of Long.</td></tr><tr><td><a href="/docs/cep/reference/functions#instanceOfString-function">instanceOfString</a></td><td>Checks if the parameter is an instance of String.</td></tr><tr><td><a href="/docs/cep/reference/functions#createset-function">createSet</a></td><td>Creates  HashSet with given input parameters.</td></tr><tr><td><a href="/docs/cep/reference/functions#sizeofset-function">sizeOfSet</a></td><td>Returns number of items in the HashSet, that&#x27;s passed as a parameter.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query that converts the <code>roomNo</code> to <code>string</code> using <code>convert</code> function, finds the maximum temperature reading with <code>maximum</code> function, and adds a unique <code>messageID</code> using the <code>UUID</code> function.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into RoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select convert(roomNo, &#x27;string&#x27;) as roomNo,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       maximum(tempReading1, tempReading2) as temp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       UUID() as messageID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">​</a></h3><p>Filters provide a way of filtering input stream events based on a specified condition. It accepts any type of condition including a combination of functions and/or attributes  that produces a Boolean result. Filters allow events to passthrough if the condition results in <code>true</code>, and drops if it results in a <code>false</code>.  </p><p><strong>Purpose</strong></p><p>Filter helps to select the events that are relevant for the processing and omit the ones that are not.</p><p><strong>Syntax</strong></p><p>Filter conditions should be defined in square brackets (<code>[]</code>) next to the input stream as shown below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;[&lt;filter condition&gt;] ;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>Query to filter <code>TempStream</code> stream events, having <code>roomNo</code> within the range of 100-210 and temperature greater than 40 degrees,
and insert them into <code>HighTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream[(roomNo &gt;= 100 and roomNo &lt; 210) and temp &gt; 40];</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="window">Window<a class="hash-link" href="#window" title="Direct link to heading">​</a></h3><p>Window provides a way to capture a subset of events from an input stream and retain them for a period of time based on a specified criterion. The criterion defines when and how the events should be evicted from the windows. Such as events getting evicted from the window based on the time duration, or number of events and they events are evicted in a sliding (one by one) or tumbling (batch) manner.</p><p>Within a query, each input stream can at most have only one window associated with it.</p><p><strong>Purpose</strong></p><p>Windows help to retain events based on a criterion, such that the values of those events can be aggregated, or checked if an event of interest is within the window or not.</p><p><strong>Syntax</strong></p><p>Window should be defined by using the <code>#window</code> prefix next to the input stream as shown below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert &lt;ouput event type&gt;? into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Filter conditions can be applied both before and/or after the window.</p></div></div><p><strong>Inbuilt windows</strong></p><p>Following are some inbuilt Stream windows, for more windows refer <a href="/docs/cep/reference/functions">execution extensions</a>.</p><table><thead><tr><th>Inbuilt function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/reference/functions#time-window">time</a></td><td>Retains events based on time in a sliding manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#timebatch-window">timeBatch</a></td><td>Retains events based on time in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#length-window">length</a></td><td>Retains events based on number of events in a sliding manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#lengthbatch-window">lengthBatch</a></td><td>Retains events based on number of events in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#timelength-window">timeLength</a></td><td>Retains events based on time and number of events in a sliding manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#session-window">session</a></td><td>Retains events for each session based on session key.</td></tr><tr><td><a href="/docs/cep/reference/functions#batch-window">batch</a></td><td>Retains events of last arrived event chunk.</td></tr><tr><td><a href="/docs/cep/reference/functions#sort-window">sort</a></td><td>Retains top-k or bottom-k events based on a parameter value.</td></tr><tr><td><a href="/docs/cep/reference/functions#cron-window">cron</a></td><td>Retains events based on cron time in a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#externalTime-window">externalTime</a></td><td>Retains events based on event time value passed as a parameter in a sliding manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#externaltimebatch-window">externalTimeBatch</a></td><td>Retains events based on event time value passed as a parameter in a a tumbling/batch manner.</td></tr><tr><td><a href="/docs/cep/reference/functions#delay-window">delay</a></td><td>Retains events and delays the output by the given time period in a sliding manner.</td></tr></tbody></table><p><strong>Example 1</strong></p><p>Query to find out the maximum temperature out of the <strong>last 10 events</strong>, using the window of <code>length</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.length(10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>length</code> window operates in a sliding manner where the following 3 event subsets are calculated and outputted when a list of 12 events are received in sequential order.</p><table><thead><tr><th>Subset</th><th>Event Range</th></tr></thead><tbody><tr><td>1</td><td>1 - 10</td></tr><tr><td>2</td><td>2 - 11</td></tr><tr><td>3</td><td>3 - 12</td></tr></tbody></table><p><strong>Example 2</strong></p><p>Query to find out the maximum temperature out of the <strong>every 10 events</strong>, using the window of <code>lengthBatch</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.lengthBatch(10);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the window operates in a batch/tumbling manner where the following 3 event subsets are calculated and outputted when a list of 30 events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Event Range</th></tr></thead><tbody><tr><td>1</td><td>1 - 10</td></tr><tr><td>2</td><td>11 - 20</td></tr><tr><td>3</td><td>21 - 30</td></tr></tbody></table><p><strong>Example 3</strong></p><p>Query to find out the maximum temperature out of the events arrived <strong>during last 10 minutes</strong>, using the window of <code>time</code> 10 minutes and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.time(10 min);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>time</code> window operates in a sliding manner with millisecond accuracy, where it will process events in the following 3 time durations and output aggregated events when a list of events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Time Range (in ms)</th></tr></thead><tbody><tr><td>1</td><td>1:00:00.001 - 1:10:00.000</td></tr><tr><td>2</td><td>1:00:01.001 - 1:10:01.000</td></tr><tr><td>3</td><td>1:00:01.033 - 1:10:01.034</td></tr></tbody></table><p><strong>Example 4</strong></p><p>Query to find out the maximum temperature out of the events arriving <strong>every 10 minutes</strong>, using the window of <code>timeBatch</code> 10 and <code>max()</code> aggregation function, from the <code>TempStream</code> stream and insert the results into the <code>MaxTempStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.timeBatch(10 min);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the window operates in a batch/tumbling manner where the window will process evetns in the following 3 time durations and output aggregated events when a list of events are received in a sequential order.</p><table><thead><tr><th>Subset</th><th>Time Range (in ms)</th></tr></thead><tbody><tr><td>1</td><td>1:00:00.001 - 1:10:00.000</td></tr><tr><td>2</td><td>1:10:00.001 - 1:20:00.000</td></tr><tr><td>3</td><td>1:20:00.001 - 1:30:00.000</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="event-type">Event Type<a class="hash-link" href="#event-type" title="Direct link to heading">​</a></h3><p>Query output depends on the <code>current</code> and <code>expired</code> event types it produces based on its internal processing state. By default all queries produce <code>current</code> events upon event arrival to the query. The queries containing windows additionally produce <code>expired</code> events when events expire from the windows.</p><p><strong>Purpose</strong></p><p>Event type helps to specify when a query should output events to the stream, such as output upon current events, expired events or upon both current and expired events.</p><p><strong>Syntax</strong></p><p>Event type should be defined in between <code>insert</code> and <code>into</code> keywords for insert queries as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert &lt;event type&gt; into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for delete queries as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for update queries as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event type should be defined next to the <code>for</code> keyword for update or insert queries as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Controlling query output based on the event types neither alters query execution nor its accuracy.  </p></div></div><p>The event types can be defined using the following keywords to manipulate query output.</p><table><thead><tr><th>Event types</th><th>Description</th></tr></thead><tbody><tr><td><code>current events</code></td><td>Outputs events only when incoming events arrive to be processed by the query.  This is default behavior when no specific event type is specified.</td></tr><tr><td><code>expired events</code></td><td>Outputs events only when events expires from the window.</td></tr><tr><td><code>all events</code></td><td>Outputs events when incoming events arrive to be processed by the query as well as  when events expire from the window.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query to output only the expired events from a 1 minute time window to the <code>DelayedTempStream</code> stream. This can be used for delaying the events by a minute.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert expired events into DelayedTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.time(1 min)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>This is just to illustrate how expired events work, it is recommended to use <a href="/docs/cep/reference/functions#delay-window">delay</a> window for usecases where we need to delay events by a given time period.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="aggregate-function">Aggregate Function<a class="hash-link" href="#aggregate-function" title="Direct link to heading">​</a></h3><p>Aggregate functions are pre-configured aggregation operations that can consumes zero, or more parameters from multiple events and always produce a single value as result. They can be only used in the query projection (as part of the <code>select</code> clause). When a query comprises a window, the aggregation will be contained to the events in the window, and when it does not have a window, the aggregation is performed from the first event the query has received.</p><p><strong>Purpose</strong></p><p>Aggregate functions encapsulate pre-configured reusable aggregate logic allowing users to aggregate values of multiple events together. When used with batch/tumbling windows this can also help to reduce the number of output events produced.  </p><p><strong>Syntax</strong></p><p>Aggregate function can be used in query projection (as part of the <code>select</code> clause) alone or as a part of another expression. In all cases, the output produced by the query should be properly mapped to the output stream attribute using the <code>as</code> keyword.</p><p>The syntax of aggregate function is as follows,</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... ) as &lt;attribute name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, &lt;parameter&gt;, ... );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here <code>&lt;aggregate function&gt;</code> uniquely identifies the aggregate function. The <code>&lt;parameter&gt;</code> defined input parameters the aggregate function can accept. The input parameters can be attributes, constant values, results of other functions or aggregate functions, results of mathematical or logical expressions, or time values. The number and type of parameters an aggregate function accepts depend on the function itself.</p><p><strong>Inbuilt aggregate functions</strong></p><p>Following are some inbuilt aggregation functions.</p><table><thead><tr><th>Inbuilt aggregate function</th><th>Description</th></tr></thead><tbody><tr><td><a href="/docs/cep/reference/functions#sum-aggregate-function">sum</a></td><td>Calculates the sum from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#count-aggregate-function">count</a></td><td>Calculates the count from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#distinctcount-aggregate-function">distinctcount</a></td><td>Calculates the distinct count based on a parameter from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#avg-aggregate-function">avg</a></td><td>Calculates the average from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#max-aggregate-function">max</a></td><td>Finds the maximum value from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#min-aggregate-function">min</a></td><td>Finds the minimum value from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#maxForever-aggregate-function">maxForever</a></td><td>Finds the maximum value from all events throughout its lifetime irrespective of the windows.</td></tr><tr><td><a href="/docs/cep/reference/functions#minForever-aggregate-function">minForever</a></td><td>Finds the minimum value from all events throughout its lifetime irrespective of the windows.</td></tr><tr><td><a href="/docs/cep/reference/functions#stdDev-aggregate-function">stddev</a></td><td>Calculates the standard deviation from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#and-aggregate-function">and</a></td><td>Calculates boolean and from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#or-aggregate-function">or</a></td><td>Calculates boolean or from a set of values.</td></tr><tr><td><a href="/docs/cep/reference/functions#unionSet-aggregate-function">unionSet</a></td><td>Calculates union as a Set from a set of values.</td></tr></tbody></table><p><strong>Example</strong></p><p>Query to calculate average, maximum, and minimum values on <code>temp</code> attribute of the <code>TempStream</code> stream in a sliding manner, from the events arrived over the last 10 minutes and to produce outputs <code>avgTemp</code>, <code>maxTemp</code> and <code>minTemp</code> respectively to the <code>AvgTempStream</code> output stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select avg(temp) as avgTemp, max(temp) as maxTemp, min(temp) as minTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.time(10 min);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="group-by">Group By<a class="hash-link" href="#group-by" title="Direct link to heading">​</a></h3><p>Group By provides a way of grouping events based on one or more specified attributes to perform aggregate operations.</p><p><strong>Purpose</strong></p><p>Group By allows users to aggregate values of multiple events based on the given group-by fields.</p><p><strong>Syntax</strong></p><p>The syntax for the Group By with aggregate function is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the group by attributes should be defined next to the <code>group by</code> keyword separating each attribute by a comma.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination, from the events arrived from <code>TempStream</code> stream, during the last 10 minutes time-window in a sliding manner.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="having">Having<a class="hash-link" href="#having" title="Direct link to heading">​</a></h3><p>Having provide a way of filtering events based on a specified condition of the query output stream attributes. It accepts any type of condition including a combination of functions and/or attributes that produces a Boolean result. Having, allow events to passthrough if the condition results in <code>true</code>, and drops if it results in a <code>false</code>.  </p><p><strong>Purpose</strong></p><p>Having helps to select the events that are relevant for the output based on the attributes those are produced by the <code>select</code> clause and omit the ones that are not.</p><p><strong>Syntax</strong></p><p>The syntax for the Having clause is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the having <code>&lt;condition&gt;</code> should be defined next to the <code>having</code> keyword and having can be used with or without <code>group by</code> clause.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> for the last 10 minutes, and alerts if the <code>avgTemp</code> exceeds 30 degrees.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having avgTemp &gt; 30;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="order-by">Order By<a class="hash-link" href="#order-by" title="Direct link to heading">​</a></h3><p>Order By, orders the query results in ascending and or descending order based on one or more specified attributes. When an attribute is used for order by, by default Stream orders the events in ascending order of that attribute&#x27;s value, and by adding <code>desc</code> keyword, the events can be ordered in descending order. When more than one attribute is defined the attributes defined towards the left will have more precedence in ordering than the ones defined in right.  </p><p><strong>Purpose</strong></p><p>Order By helps to sort the events in the outputs chunks produced by the query. Order By will be more helpful for batch windows, and queries where they output many of event together then for sliding window use cases where the output will be one or few events at a time.</p><p><strong>Syntax</strong></p><p>The syntax for the Order By clause is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by &lt;attribute1 name&gt; (asc|desc)?, &lt;attribute2 name&gt; (asc|desc)?, ...;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the order by attributes should be defined next to the <code>order by</code> keyword separating each by a comma, and optionally specifying the event ordering using <code>asc</code> (default) or <code>desc</code> keywords.</p><p><strong>Example</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination on every 10 minutes batches, and order the generated output events in ascending order by <code>avgTemp</code> and then by descending order of <code>roomNo</code> (if the more than one event have the same <code>avgTemp</code> value).</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.timeBatch(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp, roomNo desc;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="limit--offset">Limit &amp; Offset<a class="hash-link" href="#limit--offset" title="Direct link to heading">​</a></h3><p>These provide a way to select the number of events (via limit) from the desired index (by specifying an offset) from the output event chunks produced by the query.</p><p><strong>Purpose</strong></p><p>Limit &amp; Offset helps to output only the selected set of events from large event batches. This will be more useful with <code>Order By</code> clause where one can order the output for topK, bottomK, or even to paginate through the dataset by obtaining a set of events from the middle.   </p><p><strong>Syntax</strong></p><p>The syntax for the Limit &amp; Offset clauses is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;aggregate function&gt;( &lt;parameter&gt;, &lt;parameter&gt;, ...) as &lt;attribute1 name&gt;, &lt;attribute2 name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by &lt;attribute1 name&gt;, &lt;attribute2 name&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having &lt;condition&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by &lt;attribute1 name&gt; (asc | desc)?, &lt;attribute2 name&gt; (&lt;ascend/descend&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit &lt;positive integer&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset &lt;positive integer&gt;?;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here both <code>limit</code> and <code>offset</code> are optional, when <code>limit</code> is omitted the query will output all the events, and when <code>offset</code> is omitted <code>0</code> is taken as the default offset value.</p><p><strong>Example 1</strong></p><p>Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination for every 10 minutes batches, from the events arriving at the <code>TempStream</code> stream, and emit only two events having the highest <code>avgTemp</code> value.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighestAvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.timeBatch(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit 2;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example 2</strong>
Query to calculate the average <code>temp</code> per <code>roomNo</code> and <code>deviceID</code> combination for every 10 minutes batches, for events that arriving at the <code>TempStream</code> stream, and emits only the third, forth and fifth events when sorted in descending order based on their <code>avgTemp</code> value.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighestAvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream#window.timeBatch(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group by roomNo, deviceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order by avgTemp desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset 2;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="join-stream">Join (Stream)<a class="hash-link" href="#join-stream" title="Direct link to heading">​</a></h3><p>Joins allow you to get a combined result from two streams in real-time based on a specified condition.</p><p><strong>Purpose</strong></p><p>Streams are stateless. Therefore, in order to join two streams, they need to be connected to a window so that there is a pool of events that can be used for joining. Joins also accept conditions to join the appropriate events from each stream.</p><p>During the joining process each incoming event of each stream is matched against all the events in the other
stream&#x27;s window based on the given condition, and the output events are generated for all the matching event pairs.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Join can also be performed with <a href="#join-table">stored data</a>, <a href="#join-aggregation">aggregation</a> or externally <a href="#join-window">named windows</a>.</p></div></div><p><strong>Syntax</strong></p><p>The syntax for a join is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;, ... ) {unidirectional} {as &lt;reference&gt;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         join &lt;input stream&gt;#window.&lt;window name&gt;(&lt;parameter&gt;,  ... ) {unidirectional} {as &lt;reference&gt;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;join condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the <code>&lt;join condition&gt;</code> allows you to match the attributes from both the streams.</p><p><strong>Unidirectional join operation</strong></p><p>By default, events arriving at either stream can trigger the joining process. However, if you want to control the
join execution, you can add the <code>unidirectional</code> keyword next to a stream in the join definition as depicted in the
syntax in order to enable that stream to trigger the join operation. Here, events arriving at other stream only update the
window of that stream, and this stream does not trigger the join operation.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The <code>unidirectional</code> keyword cannot be applied to both the input streams because the default behaviour already allows both streams to trigger the join operation.</p></div></div><p><strong>Example</strong></p><p>Assuming that the temperature of regulators are updated every minute.
Following is a Stream App that controls the temperature regulators if they are not already <code>on</code> for all the rooms with a room temperature greater than 30 degrees.  </p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStream (deviceID long, roomNo int, isOn bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into RegulatorActionStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select T.roomNo, R.deviceID, &#x27;start&#x27; as action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream[temp &gt; 30.0]#window.time(1 min) as T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  join RegulatorStream[isOn == false]#window.length(1) as R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on T.roomNo == R.roomNo;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Supported join types</strong></p><p>Following are the supported operations of a join clause.</p><ul><li><p><strong>Inner join (join)</strong></p><p>This is the default behaviour of a join operation. <code>join</code> is used as the keyword to join both the streams. The output is generated only if there is a matching event in both the streams.</p></li><li><p><strong>Left outer join</strong></p><p>The <code>left outer join</code> operation allows you to join two streams to be merged based on a condition. <code>left outer join</code> is used as the keyword to join both the streams.</p><p>Here, it returns all the events of left stream even if there are no matching events in the right stream by
having null values for the attributes of the right stream.</p><p> <strong>Example</strong></p><p>The following query generates output events for all events from the <code>StockStream</code> stream regardless of whether a matching
symbol exists in the <code>TwitterStream</code> stream or not.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select S.symbol as symbol, T.tweet, S.price from StockStream#window.time(1 min) as S left outer join TwitterStream#window.length(1) as T on S.symbol== T.symbol insert into outputStream ;    </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Right outer join</strong></p><p>This is similar to a left outer join. <code>Right outer join</code> is used as the keyword to join both the streams.
It returns all the events of the right stream even if there are no matching events in the left stream.</p></li><li><p><strong>Full outer join</strong></p><p>The full outer join combines the results of left outer join and right outer join. <code>full outer join</code> is used as the keyword to join both the streams.
Here, output event are generated for each incoming event even if there are no matching events in the other stream.</p><p><strong>Example</strong></p><p>The following query generates output events for all the incoming events of each stream regardless of whether there is a
match for the <code>symbol</code> attribute in the other stream or not.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into outputStream select S.symbol as symbol, T.tweet, S.price from StockStream#window.time(1 min) as S full outer join TwitterStream#window.length(1) as T on S.symbol== T.symbol;    </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="patterns">Patterns<a class="hash-link" href="#patterns" title="Direct link to heading">​</a></h3><p>This is a state machine implementation that allows you to detect patterns in the events that arrive over time. This can correlate events within a single stream or between multiple streams.</p><p><strong>Purpose</strong></p><p>Patterns allow you to identify trends in events over a time period.</p><p><strong>Syntax</strong></p><p>The following is the syntax for a pattern query:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;] -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (every)? &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;] -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Items</th><th>Description</th></tr></thead><tbody><tr><td><code>-&gt;</code></td><td>This is used to indicate an event that should be following another event. The subsequent event does not necessarily have to occur immediately after the preceding event. The condition to be met by the preceding event should be added before the sign, and the condition to be met by the subsequent event should be added after the sign.</td></tr><tr><td><code>&lt;event reference&gt;</code></td><td>This allows you to add a reference to the the matching event so that it can be accessed later for further processing.</td></tr><tr><td><code>(within &lt;time gap&gt;)?</code></td><td>The <code>within</code> clause is optional. It defines the time duration within which all the matching events should occur.</td></tr><tr><td><code>every</code></td><td><code>every</code> is an optional keyword. This defines whether the event matching should be triggered for every event arrival in the specified stream with the matching condition.  When this keyword is not used, the matching is carried out only once.</td></tr></tbody></table><p>Stream also supports pattern matching with counting events and matching events in a logical order such as (<code>and</code>, <code>or</code>, and <code>not</code>). These are described in detail further below in this guide.</p><p><strong>Example</strong></p><p>This query sends an alert if the temperature of a room increases by 5 degrees within 10 min.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, e1.temp as initialTemp, e2.temp as finalTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=TempStream ) -&gt; e2=TempStream[ e1.roomNo == roomNo and (e1.temp + 5) &lt;= temp ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    within 10 min;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the matching process begins for each event in the <code>TempStream</code> stream (because <code>every</code> is used with <code>e1=TempStream</code>),
and if  another event arrives within 10 minutes with a value for the <code>temp</code> attribute that is greater than or equal to <code>e1.temp + 5</code>
of the event e1, an output is generated via the <code>AlertStream</code>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="counting-pattern">Counting Pattern<a class="hash-link" href="#counting-pattern" title="Direct link to heading">​</a></h4><p>Counting patterns allow you to match multiple events that may have been received for the same matching condition.
The number of events matched per condition can be limited via condition postfixes.</p><p><strong>Syntax</strong></p><p>Each matching condition can contain a collection of events with the minimum and maximum number of events to be matched as shown in the syntax below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;] (&lt;&lt;min count&gt;:&lt;max count&gt;&gt;)? -&gt;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Postfix</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>&lt;n1:n2&gt;</code></td><td>This matches <code>n1</code> to <code>n2</code> events (including <code>n1</code> and not more than <code>n2</code>).</td><td><code>1:4</code> matches 1 to 4 events.</td></tr><tr><td><code>&lt;n:&gt;</code></td><td>This matches <code>n</code> or more events (including <code>n</code>).</td><td><code>&lt;2:&gt;</code> matches 2 or more events.</td></tr><tr><td><code>&lt;:n&gt;</code></td><td>This matches up to <code>n</code> events (excluding <code>n</code>).</td><td><code>&lt;:5&gt;</code> matches up to 5 events.</td></tr><tr><td><code>&lt;n&gt;</code></td><td>This matches exactly <code>n</code> events.</td><td><code>&lt;5&gt;</code> matches exactly 5 events.</td></tr></tbody></table><p>Specific occurrences of the event in a collection can be retrieved by using an event index with its reference.
Square brackets can be used to indicate the event index where <code>1</code> can be used as the index of the first event and <code>last</code> can be used as the index
for the <code>last</code> available event in the event collection. If you provide an index greater then the last event index,
the system returns <code>null</code>. The following are some valid examples.</p><ul><li><code>e1[3]</code> refers to the 3rd event.</li><li><code>e1[last]</code> refers to the last event.</li><li><code>e1[last - 1]</code> refers to the event before the last event.</li></ul><p><strong>Example</strong></p><p>The following Stream App calculates the temperature difference between two regulator events.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStream (deviceID long, roomNo int, tempSet double, isOn bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into TempDiffStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, e2[0].temp - e2[last].temp as tempDiff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=RegulatorStream) -&gt; e2=TempStream[e1.roomNo==roomNo]&lt;1:&gt; -&gt; e3=RegulatorStream[e1.roomNo==roomNo];</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="logical-patterns">Logical Patterns<a class="hash-link" href="#logical-patterns" title="Direct link to heading">​</a></h4><p>Logical patterns match events that arrive in temporal order and correlate them with logical relationships such as <code>and</code>,
<code>or</code> and <code>not</code>.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? (not)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ((and|or) &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;])? (within &lt;time gap&gt;)? -&gt;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Keywords such as <code>and</code>, <code>or</code>, or <code>not</code> can be used to illustrate the logical relationship.</p><table><thead><tr><th>Key Word</th><th>Description</th></tr></thead><tbody><tr><td><code>and</code></td><td>This allows both conditions of <code>and</code> to be matched by two events in any order.</td></tr><tr><td><code>or</code></td><td>The state succeeds if either condition of <code>or</code> is satisfied. Here the event reference of the other condition is <code>null</code>.</td></tr><tr><td><code>not &lt;condition1&gt; and &lt;condition2&gt;</code></td><td>When <code>not</code> is included with <code>and</code>, it identifies the events that match <code>&lt;condition2&gt;</code> arriving before any event that match <code>&lt;condition1&gt;</code>.</td></tr><tr><td><code>not &lt;condition&gt; for &lt;time period&gt;</code></td><td>When <code>not</code> is included with <code>for</code>, it allows you to identify a situation where no event that matches <code>&lt;condition1&gt;</code> arrives during the specified <code>&lt;time period&gt;</code>.  e.g.,<code>from not TemperatureStream[temp &gt; 60] for 5 sec</code>.</td></tr></tbody></table><p>Here the <code>not</code> pattern can be followed by either an <code>and</code> clause or the effective period of <code>not</code> can be concluded after a given <code>&lt;time period&gt;</code>. Further in Stream more than two streams cannot be matched with logical conditions using <code>and</code>, <code>or</code>, or <code>not</code> clauses at this point.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="detecting-non-occurring-events">Detecting Non-occurring Events<a class="hash-link" href="#detecting-non-occurring-events" title="Direct link to heading">​</a></h4><p>Stream allows you to detect non-occurring events via multiple combinations of the key words specified above as shown in the table below.</p><p>In the patterns listed, P* can be either a regular event pattern, an absent event pattern or a logical pattern.</p><table><thead><tr><th>Pattern</th><th>Detected Scenario</th></tr></thead><tbody><tr><td><code>not A for &lt;time period&gt;</code></td><td>The non-occurrence of event A within <code>&lt;time period&gt;</code> after system start up. e.g., Generating an alert if a taxi has not reached its destination within 30 minutes, to indicate that the passenger might be in danger.</td></tr><tr><td><code>not A for &lt;time period&gt; and B</code></td><td>After system start up, event A does not occur within <code>time period</code>, but event B occurs at some point in time.  e.g., Generating an alert if a taxi has not reached its destination within 30 minutes, and the passenger marked that he/she is in danger at some point in time.</td></tr><tr><td><code>not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt;</code></td><td>After system start up, event A doess not occur within <code>time period 1</code>, and event B also does not occur within <code>&lt;time period 2&gt;</code>.  e.g., Generating an alert if the driver of a taxi has not reached the destination within 30 minutes, and the passenger has not marked himself/herself to be in danger within that same time period.</td></tr><tr><td><code>not A for &lt;time period&gt; or B</code></td><td>After system start up, either event A does not occur within <code>&lt;time period&gt;</code>, or event B occurs at some point in time.  e.g., Generating an alert if the taxi has not reached its destination within 30 minutes, or if the passenger has marked that he/she is in danger at some point in time.</td></tr><tr><td><code>not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt;</code></td><td>After system start up, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B occurs within <code>&lt;time period 2&gt;</code>.  e.g., Generating an alert to indicate that the driver is not on an expected route if the taxi has not reached destination A within 20 minutes, or reached destination B within 30 minutes.</td></tr><tr><td><code>A → not B for &lt;time period&gt;</code></td><td>Event B does not occur within <code>&lt;time period&gt;</code> after the occurrence of event A. e.g., Generating an alert if the taxi has reached its destination, but this was not followed by a payment record.</td></tr><tr><td><code>P* → not A for &lt;time period&gt; and B</code></td><td>After the occurrence of P*, event A does not occur within <code>&lt;time period&gt;</code>, and event B occurs at some point in time.</td></tr><tr><td><code>P* → not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt;</code></td><td>After the occurrence of P*, event A does not occur within <code>&lt;time period 1&gt;</code>, and event B does not occur within <code>&lt;time period 2&gt;</code>.</td></tr><tr><td><code>P* → not A for &lt;time period&gt; or B</code></td><td>After the occurrence of P*, either event A does not occur within <code>&lt;time period&gt;</code>, or event B occurs at some point in time.</td></tr><tr><td><code>P* → not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt;</code></td><td>After the occurrence of P*, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B does not occur within <code>&lt;time period 2&gt;</code>.</td></tr><tr><td><code>not A for &lt;time period&gt; → B</code></td><td>Event A does occur within <code>&lt;time period&gt;</code> after the system start up, but event B occurs after that <code>&lt;time period&gt;</code> has elapsed.</td></tr><tr><td><code>not A for &lt;time period&gt; and B → P*</code></td><td>Event A does not occur within <code>&lt;time period&gt;</code>, and event B occurs at some point in time. Then P* occurs after the <code>&lt;time period&gt;</code> has elapsed, and after B has occurred.</td></tr><tr><td><code>not A for &lt;time period 1&gt; and not B for &lt;time period 2&gt; → P*</code></td><td>After system start up, event A does not occur within <code>&lt;time period 1&gt;</code>, and event B does not occur within <code>&lt;time period 2&gt;</code>. However, P* occurs after both A and B.</td></tr><tr><td><code>not A for &lt;time period&gt; or B → P*</code></td><td>After system start up, event A does not occur within <code>&lt;time period&gt;</code> or event B occurs at some point in time. The P* occurs after <code>&lt;time period&gt;</code> has elapsed, or after B has occurred.</td></tr><tr><td><code>not A for &lt;time period 1&gt; or not B for &lt;time period 2&gt; → P*</code></td><td>After system start up, either event A does not occur within <code>&lt;time period 1&gt;</code>, or event B does not occur within <code>&lt;time period 2&gt;</code>. Then P*  occurs after both <code>&lt;time period 1&gt;</code> and <code>&lt;time period 2&gt;</code> have elapsed.</td></tr><tr><td><code>not A and B</code></td><td>Event A does not occur before event B.</td></tr><tr><td><code>A and not B</code></td><td>Event B does not occur before event A.</td></tr></tbody></table><p><strong>Example</strong></p><p>Following Stream App, sends the <code>stop</code> control action to the regulator when the key is removed from the hotel room.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RoomKeyStream (deviceID long, roomNo int, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into RegulatorActionStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo, ifThenElse( e2 is null, &#x27;none&#x27;, &#x27;stop&#x27; ) as action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every( e1=RegulatorStateChangeStream[ action == &#x27;on&#x27; ] ) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      e2=RoomKeyStream[ e1.roomNo == roomNo and action == &#x27;removed&#x27; ] or e3=RegulatorStateChangeStream[ e1.roomNo == roomNo and action == &#x27;off&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">having action != &#x27;none&#x27;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This Stream Application generates an alert if we have switch off the regulator before the temperature reaches 12 degrees.  </p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo as roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from e1=RegulatorStateChangeStream[action == &#x27;start&#x27;] -&gt; not TempStream[e1.roomNo == roomNo and temp &lt; 12] and e2=RegulatorStateChangeStream[action == &#x27;off&#x27;];</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This Stream Application generates an alert if the temperature does not reduce to 12 degrees within 5 minutes of switching on the regulator.  </p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStateChangeStream (deviceID long, roomNo int, tempSet double, action string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.roomNo as roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from e1=RegulatorStateChangeStream[action == &#x27;start&#x27;] -&gt; not TempStream[e1.roomNo == roomNo and temp &lt; 12] for &#x27;5 min&#x27;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="sequence">Sequence<a class="hash-link" href="#sequence" title="Direct link to heading">​</a></h3><p>Sequence is a state machine implementation that allows you to detect the sequence of event occurrences over time.
Here <strong>all matching events need to arrive consecutively</strong> to match the sequence condition, and there cannot be any non-matching events arriving within a matching sequence of events.
This can correlate events within a single stream or between multiple streams.</p><p><strong>Purpose</strong></p><p>This allows you to detect a specified event sequence over a specified time period.</p><p><strong>Syntax</strong></p><p>The syntax for a sequence query is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Items</th><th>Description</th></tr></thead><tbody><tr><td><code>,</code></td><td>This represents the immediate next event i.e., when an event that matches the first condition arrives, the event that arrives immediately after it should match the second condition.</td></tr><tr><td><code>&lt;event reference&gt;</code></td><td>This allows you to add a reference to the the matching event so that it can be accessed later for further processing.</td></tr><tr><td><code>(within &lt;time gap&gt;)?</code></td><td>The <code>within</code> clause is optional. It defines the time duration within which all the matching events should occur.</td></tr><tr><td><code>every</code></td><td><code>every</code> is an optional keyword. This defines whether the matching event should be triggered for every event that arrives at the specified stream with the matching condition.  When this keyword is not used, the matching is carried out only once.</td></tr></tbody></table><p><strong>Example</strong></p><p>This query generates an alert if the increase in the temperature between two consecutive temperature events exceeds one degree.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> AlertStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> initialTemp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> finalTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> every e1</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TempStream</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e2</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TempStream</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">temp</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">temp</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="counting-sequence">Counting Sequence<a class="hash-link" href="#counting-sequence" title="Direct link to heading">​</a></h4><p>Counting sequences allow you to match multiple events for the same matching condition.
The number of events matched per condition can be limited via condition postfixes such as <strong>Counting Patterns</strong>, or by using the
<code>*</code>, <code>+</code>, and <code>?</code> operators.</p><p>The matching events can also be retrieved using event indexes, similar to how it is done in <strong>Counting Patterns</strong>.</p><p><strong>Syntax</strong></p><p>Each matching condition in a sequence can contain a collection of events as shown below.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;.&lt;attribute name&gt;, &lt;event reference&gt;.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;](+|*|?)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;event reference&gt;=&lt;input stream [&lt;filter condition&gt;](+|*|?)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (within &lt;time gap&gt;)?     </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Postfix symbol</th><th>Required/Optional</th><th>Description</th></tr></thead><tbody><tr><td><code>+</code></td><td>Optional</td><td>This matches <strong>one or more</strong> events to the given condition.</td></tr><tr><td><code>*</code></td><td>Optional</td><td>This matches <strong>zero or more</strong> events to the given condition.</td></tr><tr><td><code>?</code></td><td>Optional</td><td>This matches <strong>zero or one</strong> events to the given condition.</td></tr></tbody></table><p><strong>Example</strong></p><p>This Stream application identifies temperature peeks.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into PeekTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e1.temp as initialTemp, e2[last].temp as peakTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every e1=TempStream, e2=TempStream[e1.temp &lt;= temp]+, e3=TempStream[e2[last].temp &gt; temp];</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="logical-sequence">Logical Sequence<a class="hash-link" href="#logical-sequence" title="Direct link to heading">​</a></h4><p>Logical sequences identify logical relationships using <code>and</code>, <code>or</code> and <code>not</code> on consecutively arriving events.</p><p><strong>Syntax</strong>
The syntax for a logical sequence is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;event reference&gt;([event index])?.&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from (every)? (not)? &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ((and|or) &lt;event reference&gt;=&lt;input stream&gt;[&lt;filter condition&gt;])? (within &lt;time gap&gt;)?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Keywords such as <code>and</code>, <code>or</code>, or <code>not</code> can be used to illustrate the logical relationship, similar to how it is done in <strong>Logical Patterns</strong>.</p><p><strong>Example</strong></p><p>This Stream application notifies the state when a regulator event is immediately followed by both temperature and humidity events.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(deviceID long, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM HumidStream(deviceID long, humid double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RegulatorStream(deviceID long, isOn bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into StateNotificationStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select e2.temp, e3.humid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from every e1=RegulatorStream, e2=TempStream and e3=HumidStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="output-rate-limiting">Output rate limiting<a class="hash-link" href="#output-rate-limiting" title="Direct link to heading">​</a></h3><p>Output rate limiting allows queries to output events periodically based on a specified condition.</p><p><strong>Purpose</strong></p><p>This allows you to limit the output to avoid overloading the subsequent executions, and to remove unnecessary information.</p><p><strong>Syntax</strong></p><p>The syntax of an output rate limiting configuration is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output &lt;rate limiting configuration&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Stream supports three types of output rate limiting configurations as explained in the following table:</p><table><thead><tr><th>Rate limiting configuration</th><th>Syntax</th><th>Description</th></tr></thead><tbody><tr><td>Based on time</td><td><code>&lt;output event&gt; every &lt;time interval&gt;</code></td><td>This outputs <code>&lt;output event&gt;</code> every <code>&lt;time interval&gt;</code> time interval.</td></tr><tr><td>Based on number of events</td><td><code>&lt;output event&gt; every &lt;event interval&gt; events</code></td><td>This outputs <code>&lt;output event&gt;</code> for every <code>&lt;event interval&gt;</code> number of events.</td></tr><tr><td>Snapshot based output</td><td><code>snapshot every &lt;time interval&gt;</code></td><td>This outputs all events in the window (or the last event if no window is defined in the query) for every given <code>&lt;time interval&gt;</code> time interval.</td></tr></tbody></table><p>Here the <code>&lt;output event&gt;</code> specifies the event(s) that should be returned as the output of the query.
The possible values are as follows:</p><ul><li><code>first</code> : Only the first event processed by the query during the specified time interval/sliding window is emitted.</li><li><code>last</code> : Only the last event processed by the query during the specified time interval/sliding window is emitted.</li><li><code>all</code> : All the events processed by the query during the specified time interval/sliding window are emitted. <strong>When no <code>&lt;output event&gt;</code> is defined, <code>all</code> is used by default.</strong></li></ul><p><strong>Examples</strong></p><ul><li><p>Returning events based on the number of events</p><p>  Here, events are emitted every time the specified number of events arrive. You can also specify whether to emit only the first event/last event, or all the events out of the events that arrived.</p><p>  In this example, the last temperature per sensor is emitted for every 10 events.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into LowRateTempStream select temp, deviceID from TempStreamselect group by deviceID output last every 10 events;    </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Returning events based on time</p><p>  Here events are emitted for every predefined time interval. You can also specify whether to emit only the first event, last event, or all events out of the events that arrived during the specified time interval.</p><p>  In this example, emits all temperature events every 10 seconds  </p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into LowRateTempStream from TempStreamoutput output every 10 sec;    </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Returning a periodic snapshot of events</p><p>  This method works best with windows. When an input stream is connected to a window, snapshot rate limiting emits all the current events that have arrived and do not have corresponding expired events for every predefined time interval.
If the input stream is not connected to a window, only the last current event for each predefined time interval is emitted.</p><p>  This query emits a snapshot of the events in a time window of 5 seconds every 1 second.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into SnapshotTempStream from TempStream#window.time(5 sec) output snapshot every 1 sec;    </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="partition">Partition<a class="hash-link" href="#partition" title="Direct link to heading">​</a></h2><p>Partitions divide streams and queries into isolated groups in order to process them in parallel and in isolation. A partition can contain one or more queries and there can be multiple instances where the same queries and streams are replicated for each partition.</p><p>Each partition is tagged with a partition key. Those partitions only process the events that match the corresponding partition key.</p><p><strong>Purpose</strong></p><p>Partitions allow you to process the events groups in isolation so that event processing can be performed using the same set of queries for each group.</p><p><strong>Partition key generation</strong></p><p>A partition key can be generated in the following two methods:</p><ul><li><p>Partition by value</p><p>  This is created by generating unique values using input stream attributes.</p><p>  <strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">partition with ( &lt;expression&gt; of &lt;stream name&gt;, &lt;expression&gt; of &lt;stream name&gt;, ... ) begin &lt;query&gt; &lt;query&gt; ... end; </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>  <strong>Example</strong></p><p>  This query calculates the maximum temperature recorded within the last 10 events per <code>deviceID</code>.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">partition with ( deviceID of TempStream ) begin insert into DeviceTempStream select roomNo, deviceID, max(temp) as maxTemp from TempStream#window.length(10); end;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Partition by range</p><p>  This is created by mapping each partition key to a range condition of the input streams numerical attribute.</p><p>  <strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">partition with ( &lt;condition&gt; as &lt;partition key&gt; or &lt;condition&gt; as &lt;partition key&gt; or ... of &lt;stream name&gt;, ... ) begin &lt;query&gt; &lt;query&gt; ... end;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>  <strong>Example</strong></p><p>  This query calculates the average temperature for the last 10 minutes per office area.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">partition with ( roomNo &gt;= 1030 as &#x27;serverRoom&#x27; or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 roomNo &lt; 1030 and roomNo &gt;= 330 as &#x27;officeRoom&#x27; or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 roomNo &lt; 330 as &#x27;lobby&#x27; of TempStream)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insert into AreaTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from TempStream#window.time(10 min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="inner-stream">Inner Stream<a class="hash-link" href="#inner-stream" title="Direct link to heading">​</a></h3><p>Queries inside a partition block can use inner streams to communicate with each other while preserving partition isolation. Inner streams are denoted by a &quot;#&quot; placed before the stream name, and these streams cannot be accessed outside a partition block.</p><p><strong>Purpose</strong></p><p>Inner streams allow you to connect queries within the partition block so that the output of a query can be used as an input only by another query
within the same partition. Therefore, you do not need to repartition the streams if they are communicating within the partition.</p><p><strong>Example</strong></p><p>This partition calculates the average temperature of every 10 events for each sensor, and sends an output to the <code>DeviceTempIncreasingStream</code> stream if the consecutive average temperature values increase by more than
5 degrees.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">partition with ( deviceID of TempStream )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insert into #AvgTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    select roomNo, deviceID, avg(temp) as avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from TempStream#window.lengthBatch(10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insert into DeviceTempIncreasingStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    select e1.deviceID, e1.avgTemp as initialAvgTemp, e2.avgTemp as finalAvgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from every (e1=#AvgTempStream),e2=#AvgTempStream[e1.avgTemp + 5 &lt; avgTemp]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="purge-partition">Purge Partition<a class="hash-link" href="#purge-partition" title="Direct link to heading">​</a></h3><p>Based on the partition key used for the partition, multiple instances of streams and queries will be generated. When an extremely large number of unique partition keys are used there is a possibility of very high instances of streams and queries getting generated and eventually system going out of memory. In order to overcome this, users can define a purge interval to clean partitions that will not be used anymore.</p><p><strong>Purpose</strong></p><p><code>@purge</code> allows you to clean the partition instances that will not be used anymore.</p><p><strong>Syntax</strong></p><p>The syntax of partition purge configuration is as follows:</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@purge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">enable</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&lt;purge interval&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> idle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">period</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&lt;idle period of partition instance&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">partition</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">partition</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">key</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">output stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using purge with an Aggregation, use a <code>WITH()</code> property instead. For example:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Partition purge configuration</th><th>Description</th></tr></thead><tbody><tr><td>Purge interval</td><td>The periodic time interval to purge the purgeable partition instances.</td></tr><tr><td>Idle period of partition instance</td><td>The period, a particular partition instance (for a given partition key) needs to be idle before it becomes purgeable.</td></tr></tbody></table><p><strong>Examples</strong></p><p>Mark partition instances eligible for purging, if there are no events from a particular deviceID for 15 seconds, and periodically purge those partition instances every 1 second.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@purge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">enable</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1 sec&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> idle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">period</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;15 sec&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">partition</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> deviceID </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> TempStream </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#AvgTempStream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> roomNo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> deviceID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">avg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">temp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> avgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> TempStream</span><span class="token comment" style="color:#999988;font-style:italic">#window.lengthBatch(10)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> DeviceTempIncreasingStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deviceID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">avgTemp </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> initialAvgTemp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">avgTemp </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> finalAvgTemp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> every </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e1</span><span class="token operator" style="color:#393A34">=</span><span class="token comment" style="color:#999988;font-style:italic">#AvgTempStream),e2=#AvgTempStream[e1.avgTemp + 5 &lt; avgTemp]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="table-collection">Table (Collection)<a class="hash-link" href="#table-collection" title="Direct link to heading">​</a></h2><p>A table is a stored version of an stream or a table of events. Its schema is defined via the <strong>table definition</strong> that is similar to a stream definition. These events are stored in database.</p><p><strong>Purpose</strong></p><p>Tables allow stream processor to work with stored events. By defining a schema for tables stream processor enables them to be processed by queries using their defined attributes with the streaming data. You can also interactively query the state of the stored events in the table.</p><p><strong>Syntax</strong></p><p>The syntax for a new table definition is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE &lt;table name&gt; (&lt;attribute name&gt; &lt;attribute type&gt;, &lt;attribute name&gt; &lt;attribute type&gt;, ... );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are configured in a table definition:</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>table name</code></td><td>The name of the table defined. (<code>PascalCase</code> is used for table name as a convention.)</td></tr><tr><td><code>attribute name</code></td><td>The schema of the table is defined by its attributes with uniquely identifiable attribute names (<code>camelCase</code> is used for attribute names as a convention.)</td></tr><tr><td><code>attribute type</code></td><td>The type of each attribute defined in the schema.  This can be <code>STRING</code>, <code>INT</code>, <code>LONG</code>, <code>DOUBLE</code>, <code>FLOAT</code>, <code>BOOL</code> or <code>OBJECT</code>.</td></tr></tbody></table><p><strong>Example</strong></p><p>The following defines a table named <code>RoomTypeTable</code> with <code>roomNo</code> and <code>type</code> attributes of data types <code>int</code> and <code>string</code> respectively.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomTypeTable ( roomNo int, type string );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="primary-keys">Primary Keys<a class="hash-link" href="#primary-keys" title="Direct link to heading">​</a></h3><p>Tables can be configured with primary keys to avoid the duplication of data.</p><p>Primary keys are configured by including the <code>PrimaryKey</code> property to the table definition. Each event table configuration can have only one <code>PrimaryKey</code> property. The number of attributes supported differ based on the table implementations. When more than one attribute is used for the primary key, the uniqueness of the events stored in the table is determined based on the combination of values for those attributes.</p><p><strong>Examples</strong></p><p>This query creates an event table with the <code>symbol</code> attribute as the primary key. Therefore each entry in this table must have a unique value for <code>symbol</code> attribute.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE StockTable WITH (PrimaryKey=&#x27;symbol&#x27;, Index=&#x27;key1&#x27;, Index=&#x27;key2&#x27;) (symbol string, price float, volume long);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="indexes">Indexes<a class="hash-link" href="#indexes" title="Direct link to heading">​</a></h3><p>Indexes allow tables to be searched/modified much faster.</p><p>Indexes are configured by including the <code>@Index( &#x27;key1&#x27;, &#x27;key2&#x27; )</code> annotation to the table definition. Each event table configuration can have 0-1 <code>@Index</code> annotations. Support for the <code>@Index</code> annotation and the number of attributes supported differ based on the table type i.e., <code>doc collection</code> or <code>edge collection</code>. When more then one attribute is used for index, each one of them is used to index the table for fast access of the data.</p><p>Indexes can be configured together with primary keys.</p><p><strong>Examples</strong></p><p>This query creates an indexed event table named <code>RoomTypeTable</code> with the <code>roomNo</code> attribute as the index key.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">@Index(&#x27;roomNo&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomTypeTable (roomNo int, type string);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="store">Store<a class="hash-link" href="#store" title="Direct link to heading">​</a></h3><p>Store is a table that refers to data/events stored in data stores outside of stream. Store is defined via the <code>@store</code> annotation, and the store schema is defined via a <strong>table definition</strong> associated with it.</p><p><strong>Purpose</strong></p><p>Store allows stream processor to search, retrieve and manipulate data stored in database through stream queries.</p><p><strong>Syntax</strong></p><p>The syntax for a defining store and it&#x27;s associated table definition is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE TableName WITH (store.type=&#x27;store_type&#x27;, static.option.key1=&#x27;static_option_value1&#x27;, static.option.keyN=&#x27;static_option_valueN&#x27;) (attribute1 Type1, attributeN TypeN);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>The following defines a database having a table <code>RoomTypeTable</code> with columns <code>roomNo</code> of <code>INTEGER</code> and <code>type</code> of <code>VARCHAR(255)</code> mapped to Stream data types <code>int</code> and <code>string</code> respectively.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomTypeTable WITH (Store.type=&quot;database&quot;, collection=&quot;RoomTypeTable&quot;) ( roomNo int, type string );</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Operators on Table</strong></p><p>The following operators can be performed on tables.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="insert">Insert<a class="hash-link" href="#insert" title="Direct link to heading">​</a></h3><p>This allows events to be inserted into tables. This is similar to inserting events into streams.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>If the table is defined with primary keys, and if you insert duplicate data, primary key constrain violations can occur.
In such cases use the <code>update or insert into</code> operation.</p></div></div><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similar to streams, you need to use the <code>current events</code>, <code>expired events</code> or the <code>all events</code> keyword between <code>insert</code> and <code>into</code> keywords in order to insert only the specific event types.</p><p>For more information, see <a href="#event-type">Event Type</a></p><p><strong>Example</strong></p><p>This query inserts all the events from the <code>TempStream</code> stream to the <code>TempTable</code> table.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into TempTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="join-table">Join (Table)<a class="hash-link" href="#join-table" title="Direct link to heading">​</a></h3><p>This allows a stream to retrieve information from a table in a streaming manner.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Joins can also be performed with <a href="#join-stream">two streams</a>, <a href="#join-aggregation">aggregation</a> or against externally <a href="#join-window">named windows</a>.</p></div></div><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select (&lt;input stream&gt;|&lt;table&gt;).&lt;attribute name&gt;, (&lt;input stream&gt;|&lt;table&gt;).&lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; join &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A table can only be joint with a stream. Two tables cannot be joint because there must be at least one active
entity to trigger the join operation.</p></div></div><p><strong>Example</strong></p><p>This Stream App performs a join to retrieve the room type from <code>RoomTypeTable</code> table based on the room number, so that it can filter the events related to <code>server-room</code>s.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomTypeTable (roomNo int, type string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into ServerRoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select deviceID, RoomTypeTable.type as roomType, type, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    having roomType == &#x27;server-room&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream join RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomTypeTable.roomNo == TempStream.roomNo;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Supported join types</strong></p><p>Table join supports following join operations.</p><ul><li><p><strong>Inner join (join)</strong></p><p>This is the default behaviour of a join operation. <code>join</code> is used as the keyword to join the stream with the table. The output is generated only if there is a matching event in both the stream and the table.</p></li><li><p><strong>Left outer join</strong></p><p>The <code>left outer join</code> operation allows you to join a stream on left side with a table on the right side based on a condition.
Here, it returns all the events of left stream even if there are no matching events in the right table by
having null values for the attributes of the right table.</p></li><li><p><strong>Right outer join</strong></p><p>This is similar to a <code>left outer join</code>. <code>right outer join</code> is used as the keyword to join a stream on right side with a table on the left side based on a condition.
It returns all the events of the right stream even if there are no matching events in the left table.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="delete">Delete<a class="hash-link" href="#delete" title="Direct link to heading">​</a></h3><p>To delete selected events that are stored in a table.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which events are selected to be deleted. When specifying the condition, table attributes should be referred to with the table name.</p><p>To execute delete for specific event types, use the <code>current events</code>, <code>expired events</code> or the <code>all events</code> keyword with <code>for</code> as shown in the syntax. For more information, see <a href="#event-type">Event Type</a></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes must be always referred to with the table name as follows:
<code>&lt;table name&gt;.&lt;attibute name&gt;</code></p></div></div><p><strong>Example</strong></p><p>In this example, the script deletes a record in the <code>RoomTypeTable</code> table if it has a value for the <code>roomNo</code> attribute that matches the value for the <code>roomNumber</code> attribute of an event in the <code>DeleteStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomTypeTable (roomNo int, type string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM DeleteStream (roomNumber int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from DeleteStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomTypeTable.roomNo == roomNumber;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="update">Update<a class="hash-link" href="#update" title="Direct link to heading">​</a></h3><p>This operator updates selected event attributes stored in a table based on a condition.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which events are selected to be updated. When specifying the <code>condition</code>, table attributes must be referred to with the table name.</p><p>You can use the <code>set</code> keyword to update selected attributes from the table. Here, for each assignment, the attribute specified in the left must be the table attribute, and the one specified in the right can be a stream/table attribute a mathematical operation, or other. When the <code>set</code> clause is not provided, all the attributes in the table are updated.</p><p>To execute an update for specific event types use the <code>current events</code>, <code>expired events</code> or the <code>all events</code> keyword with <code>for</code> as shown in the syntax. For more information, see <a href="#event-type">Event Type</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes must be always referred to with the table name as shown below:
<code>&lt;table name&gt;.&lt;attibute name&gt;</code>.</p></div></div><p><strong>Example</strong></p><p>This stream application updates the room occupancy in the <code>RoomOccupancyTable</code> table for each room number based on new arrivals and exits from the <code>UpdateStream</code> stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomOccupancyTable (roomNo int, people int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM UpdateStream (roomNumber int, arrival int, exit int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from UpdateStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update RoomOccupancyTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set RoomOccupancyTable.people = RoomOccupancyTable.people + arrival - exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomOccupancyTable.roomNo == roomNumber;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="update-or-insert">Update or Insert<a class="hash-link" href="#update-or-insert" title="Direct link to heading">​</a></h3><p>This allows you update if the event attributes already exist in the table based on a condition, or else insert the entry as a new attribute.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into &lt;table&gt; (for &lt;event type&gt;)?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which events are selected for update. When specifying the <code>condition</code>, table attributes should be referred to with the table name. If a record that matches the condition does not already exist in the table, the arriving event is inserted into the table.</p><p>The <code>set</code> clause is only used when an update is performed during the insert/update operation. When <code>set</code> clause is used, the attribute to the left is always a table attribute, and the attribute to the right can be a stream/table attribute, mathematical operation or other. The attribute to the left (i.e., the attribute in the event table) is updated with the value of the attribute to the right if the given condition is met. When the <code>set</code> clause is not provided, all the attributes in the table are updated.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>When the attribute to the right is a table attribute, the operations supported differ based on the database type.</p></div></div><p>To execute update upon specific event types use the <code>current events</code>, <code>expired events</code> or the <code>all events</code> keyword with <code>for</code> as shown in the syntax. To understand more see <a href="#event-type">Event Type</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes should be always referred to with the table name as <code>&lt;table name&gt;.&lt;attibute name&gt;</code>.</p></div></div><p><strong>Example</strong></p><p>The following query update for events in the <code>UpdateTable</code> event table that have room numbers that match the same in the <code>UpdateStream</code> stream. When such events are found in the event table, they are updated. When a room number available in the stream is not found in the event table, it is inserted from the stream.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE RoomAssigneeTable (roomNo int, type string, assignee string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM RoomAssigneeStream (roomNumber int, type string, assignee string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select roomNumber as roomNo, type, assignee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from RoomAssigneeStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into RoomAssigneeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set RoomAssigneeTable.assignee = assignee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomAssigneeTable.roomNo == roomNo;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="in">In<a class="hash-link" href="#in" title="Direct link to heading">​</a></h3><p>This allows the stream to check whether the expected value exists in the table as a part of a conditional operation.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;[&lt;condition&gt; in &lt;table&gt;]</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which events are selected to be compared. When constructing the <code>condition</code>, the table attribute must be always referred to with the table name as shown below:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;table&gt;.&lt;attibute name&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>This Stream application filters only room numbers that are listed in the <code>ServerRoomTable</code> table.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE ServerRoomTable (roomNo int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream (deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into ServerRoomTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream[ServerRoomTable.roomNo == roomNo in ServerRoomTable];</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="named-aggregation">Named Aggregation<a class="hash-link" href="#named-aggregation" title="Direct link to heading">​</a></h2><p>Named aggregation allows you to obtain aggregates in an incremental manner for a specified set of time periods.</p><p>This not only allows you to calculate aggregations with varied time granularity, but also allows you to access them in an interactive
manner for reports, dashboards, and for further processing. Its schema is defined via the <em>aggregation definition</em>.</p><p><strong>Purpose</strong></p><p>Named aggregation allows you to retrieve the aggregate values for different time durations.
That is, it allows you to obtain aggregates such as <code>sum</code>, <code>count</code>, <code>avg</code>, <code>min</code>, <code>max</code>, <code>count</code> and <code>distinctCount</code>
of stream attributes for durations such as <code>sec</code>, <code>min</code>, <code>hour</code>, etc.</p><p>This is of considerable importance in many Analytics scenarios because aggregate values are often needed for several time periods.
Furthermore, this ensures that the aggregations are not lost due to unexpected system failures because aggregates can be stored in different persistence <code>stores</code>.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE AGGREGATION &lt;aggregator name&gt; WITH (store.type=&#x27;&lt;store type&gt;&#x27;, purge.enable=&#x27;&lt;true or false&gt;&#x27;, purge.interval=&#x27;&lt;purging interval&gt;&#x27;, purge.retention.period=&#x27;&lt;retention period&gt;&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;aggregate function&gt;(&lt;attribute name&gt;) as &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    group by &lt;attribute name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aggregate by &lt;timestamp attribute&gt; every &lt;time periods&gt; ;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above syntax includes the following:</p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td><code>store</code></td><td>This annotation is used to refer to the data store where the calculated aggregate results are stored. This annotation is optional. When no annotation is provided, the data is stored in the <code>in-memory</code> store.</td></tr><tr><td><code>purge</code></td><td>This annotation is used to configure purging in aggregation granularities. If this annotation is not provided, the default purging mentioned above is applied. If you want to disable automatic data purging, you can use this annotation as follows:<code>purge.enable=&#x27;false&#x27;</code>/You should disable data purging if the aggregation query in included in the Stream application for read-only purposes.</td></tr><tr><td><code>purge.retention.Period</code></td><td>This annotation is used to specify the length of time the data needs to be retained when carrying out data purging. If this annotation is not provided, the default retention period is applied.</td></tr><tr><td><code>&lt;aggregator name&gt;</code></td><td>This specifies a unique name for the aggregation so that it can be referred when accessing aggregate results.</td></tr><tr><td><code>&lt;input stream&gt;</code></td><td>The stream that feeds the aggregation. <strong>Note! this stream should be already defined.</strong></td></tr><tr><td><code>group by &lt;attribute name&gt;</code></td><td>The <code>group by</code> clause is optional. If it is included in a Stream application, aggregate values  are calculated per each <code>group by</code> attribute. If it is not used, all the events are aggregated together.</td></tr><tr><td><code>by &lt;timestamp attribute&gt;</code></td><td>This clause is optional. This defines the attribute that should be used as the timestamp. If this clause is not used, the event time is used by default. The timestamp could be given as either a <code>string</code> or a <code>long</code> value. If it is a <code>long</code> value, the unix timestamp in milliseconds is expected (e.g. <code>1496289950000</code>). If it is a <code>string</code> value, the supported formats are <code>&lt;yyyy&gt;-&lt;MM&gt;-&lt;dd&gt; &lt;HH&gt;:&lt;mm&gt;:&lt;ss&gt;</code> (if time is in GMT) and  <code>&lt;yyyy&gt;-&lt;MM&gt;-&lt;dd&gt; &lt;HH&gt;:&lt;mm&gt;:&lt;ss&gt; &lt;Z&gt;</code> (if time is not in GMT), here the ISO 8601 UTC offset must be provided for <code>&lt;Z&gt;</code> .(e.g., <code>+05:30</code>, <code>-11:00</code>).</td></tr><tr><td><code>&lt;time periods&gt;</code></td><td>Time periods can be specified as a range where the minimum and the maximum value are separated by three dots, or as comma-separated values.  e.g., A range can be specified as sec...year where aggregation is done per second, minute, hour, day, month and year. Comma-separated values can be specified as min, hour.  Skipping time durations (e.g., min, day where the hour duration is skipped) when specifying comma-separated values is supported only from v4.1.1 onwards</td></tr></tbody></table><p> Aggregation&#x27;s granularity data holders are automatically purged every 15 minutes. When carrying out data purging, the retention period you have specified for each granularity in the named aggregation query is taken into account. The retention period defined for a granularity needs to be greater than or equal to its minimum retention period as specified in the table below. If no valid retention period is defined for a granularity, the default retention period (as specified in the table below) is applied.</p><table><thead><tr><th>Granularity</th><th>Default retention</th><th>Minimum retention</th></tr></thead><tbody><tr><td><code>second</code></td><td><code>120</code> seconds</td><td><code>120</code> seconds</td></tr><tr><td><code>minute</code></td><td><code>24</code>  hours</td><td><code>120</code> minutes</td></tr><tr><td><code>hour</code></td><td><code>30</code>  days</td><td><code>25</code>  hours</td></tr><tr><td><code>day</code></td><td><code>1</code>   year</td><td><code>32</code>  days</td></tr><tr><td><code>month</code></td><td><code>All</code></td><td><code>13</code>  month</td></tr><tr><td><code>year</code></td><td><code>All</code></td><td><code>none</code></td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Aggregation is carried out at calendar start times for each granularity with the GMT timezone</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>the aggregation input stream should only feed events to one aggregation definition).</p></div></div><p><strong>Example</strong></p><p>This Stream Application defines an aggregation named <code>TradeAggregation</code> to calculate the average and sum for the <code>price</code> attribute of events arriving at the <code>TradeStream</code> stream. These aggregates are calculated per every time granularity in the second-year range.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> STREAM TradeStream </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">symbol string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> price </span><span class="token keyword" style="color:#00009f">double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> volume long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token plain"> long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> AGGREGATION TradeAggregation </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">enable</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">interval</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;10 sec&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sec</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;120 sec&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">min</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;24 hours&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hours</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;30 days&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1 year&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">months</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">purge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">retentionPeriod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">years</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> TradeStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> symbol</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">avg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">price</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> avgPrice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">price</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> total</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aggregate </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token plain"> every sec </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">year</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="distributed-aggregation">Distributed Aggregation<a class="hash-link" href="#distributed-aggregation" title="Direct link to heading">​</a></h3><p>Distributed Aggregation allows you to partially process aggregations in different shards. This allows Stream app in one shard to be responsible only for processing a part of the aggregation.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">@store(type=&quot;&lt;store type&gt;&quot;, ...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE AGGREGATION &lt;aggregator name&gt; WITH (PartitionById.enable=&#x27;false&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;aggregate function&gt;(&lt;attribute name&gt;) as &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    group by &lt;attribute name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aggregate by &lt;timestamp attribute&gt; every &lt;time periods&gt; ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Following table includes the <code>annotation</code> to be used to enable distributed aggregation,</p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td><code>@artitionById</code></td><td>If the property is given, then the distributed aggregation is enabled. Further this can be disabled by using <code>enable</code> element, <code>PartitionById.enable=&#x27;false&#x27;</code>.</td></tr></tbody></table><p>Further, following system properties are also available,</p><table><thead><tr><th>System Property</th><th>Description</th><th>Possible Values</th><th>Optional</th><th>Default Value</th></tr></thead><tbody><tr><td>shardId</td><td>The id of the shard one of the distributed aggregation is running in. This should be unique to a single shard</td><td>Any string</td><td>No</td><td>&lt;Empty_String&gt;</td></tr><tr><td>partitionById</td><td>This allows user to enable/disable distributed aggregation for all aggregations running in one stream processing manager.</td><td>true/false</td><td>Yesio</td><td>false</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ShardIds should not be changed after the first configuration in order to keep data consistency.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="join-aggregation">Join (Aggregation)<a class="hash-link" href="#join-aggregation" title="Direct link to heading">​</a></h3><p>This allows a stream to retrieve calculated aggregate values from the aggregation.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A join can also be performed with <a href="#join-stream">two streams</a>, with a <a href="#join-table">table</a> and a stream, or with a stream against externally <a href="#join-window">named windows</a>.</p></div></div><p><strong>Syntax</strong></p><p>A join with aggregation is similer to the join with <a href="#join-table">table</a>, but with additional <code>within</code> and <code>per</code> clauses.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt; join &lt;aggrigation&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on &lt;join condition&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within &lt;time range&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per &lt;time granularity&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;output stream&gt;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Apart from constructs of <a href="#join-table">table join</a> this includes the following. Please note that the &#x27;on&#x27; condition is optional :</p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td><code>within  &lt;time range&gt;</code></td><td>This allows you to specify the time interval for which the aggregate values need to be retrieved. This can be specified by providing the start and end time separated by a comma as <code>string</code> or <code>long</code> values, or by using the wildcard <code>string</code> specifying the data range. For details refer examples.</td></tr><tr><td><code>per &lt;time granularity&gt;</code></td><td>This specifies the time granularity by which the aggregate values must be grouped and returned. e.g., If you specify <code>days</code>, the retrieved aggregate values are grouped for each day within the selected time interval.</td></tr></tbody></table><p><code>within</code> and <code>per</code> clauses also accept attribute values from the stream.
The timestamp of the aggregations can be accessed through the <code>AGG_TIMESTAMP</code> attribute.</p><p><strong>Example</strong></p><p>Following aggregation definition will be used for the examples.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TradeStream (symbol string, price double, volume long, timestamp long);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE AGGREGATION TradeAggregation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select AGG_TIMESTAMP, symbol, avg(price) as avgPrice, sum(price) as total</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    group by symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aggregate by timestamp every sec ... year</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TradeStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This query retrieves daily aggregations within the time range <code>&quot;2014-02-15 00:00:00 +05:30&quot;, &quot;2014-03-16 00:00:00 +05:30&quot;</code> (Please note that +05:30 can be omitted if timezone is GMT)</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM StockStream (symbol string, value int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AggregateStockStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select S.symbol, T.total, T.avgPrice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from StockStream as S join TradeAggregation as T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on S.symbol == T.symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within &quot;2014-02-15 00:00:00 +05:30&quot;, &quot;2014-03-16 00:00:00 +05:30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per &quot;days&quot;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This query retrieves hourly aggregations within the day <code>2014-02-15</code>.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM StockStream (symbol string, value int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AggregateStockStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select S.symbol, T.total, T.avgPrice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from StockStream as S join TradeAggregation as T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on S.symbol == T.symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within &quot;2014-02-15 **:**:** +05:30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per &quot;hours&quot;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This query retrieves all aggregations per <code>perValue</code> stream attribute within the time period between timestamps <code>1496200000000</code> and <code>1596434876000</code>.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM StockStream (symbol string, value int, perValue string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into AggregateStockStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select S.symbol, T.total, T.avgPrice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from StockStream as S join TradeAggregation as T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on S.symbol == T.symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within 1496200000000L, 1596434876000L</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per S.perValue;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Supported join types</strong></p><p>Aggregation join supports following join operations.</p><ul><li><p><strong>Inner join (join)</strong></p><p>This is the default behaviour of a join operation. <code>join</code> is used as the keyword to join the stream with the aggregation. The output is generated only if there is a matching event in the stream and the aggregation.</p></li><li><p><strong>Left outer join</strong></p><p>The <code>left outer join</code> operation allows you to join a stream on left side with a aggregation on the right side based on a condition.
Here, it returns all the events of left stream even if there are no matching events in the right aggregation by
having null values for the attributes of the right aggregation.</p></li><li><p><strong>Right outer join</strong></p><p>This is similar to a <code>left outer join</code>. <code>right outer join</code> is used as the keyword to join a stream on right side with a aggregation on the left side based on a condition.
It returns all the events of the right stream even if there are no matching events in the left aggregation.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="named-window">Named Window<a class="hash-link" href="#named-window" title="Direct link to heading">​</a></h2><p>A named window is a window that can be shared across multiple queries. Events can be inserted to a named window from one or more queries and it can produce output events based on the named window type.</p><p><strong>Syntax</strong></p><p>The syntax for a named window is as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW &lt;window name&gt; (&lt;attribute name&gt; &lt;attribute type&gt;, &lt;attribute name&gt; &lt;attribute type&gt;, ... ) &lt;window type&gt;(&lt;parameter&gt;, &lt;parameter&gt;, …) &lt;event type&gt;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are configured in a table definition:</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>window name</code></td><td>The name of the window defined. (<code>PascalCase</code> is used for window names as a convention.)</td></tr><tr><td><code>attribute name</code></td><td>The schema of the window is defined by its attributes with uniquely identifiable attribute names (<code>camelCase</code> is used for attribute names as a convention.)</td></tr><tr><td><code>attribute type</code></td><td>The type of each attribute defined in the schema.  This can be <code>STRING</code>, <code>INT</code>, <code>LONG</code>, <code>DOUBLE</code>, <code>FLOAT</code>, <code>BOOL</code> or <code>OBJECT</code>.</td></tr><tr><td><code>&lt;window type&gt;(&lt;parameter&gt;, ...)</code></td><td>The window type associated with the window and its parameters.</td></tr><tr><td><code>output &lt;event type&gt;</code></td><td>This is optional. Keywords such as <code>current events</code>, <code>expired events</code> and <code>all events</code> (the default) can be used to specify when the window output should be exposed. For more information, see <a href="#event-type">Event Type</a>.</td></tr></tbody></table><p><strong>Examples</strong></p><ul><li><p>Returning all output when events arrive and when events expire from the window.</p><p>  In this query, the event type is not specified. Therefore, it returns both current and expired events as the output.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW SensorWindow (name string, value float, roomNo int, deviceID string) timeBatch(1 second);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Returning an output only when events expire from the window.</p><p>  In this query, the event type of the window is <code>expired events</code>. Therefore, it only returns the events that have expired from the window as the output.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW SensorWindow (name string, value float, roomNo int, deviceID string) timeBatch(1 second) output expired events;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p><strong>Operators on Named Windows</strong></p><p>The following operators can be performed on named windows.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="insert-1">Insert<a class="hash-link" href="#insert-1" title="Direct link to heading">​</a></h3><p>This allows events to be inserted into windows. This is similar to inserting events into streams.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;window&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;input stream&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To insert only events of a specific event type, add the <code>current events</code>, <code>expired events</code> or the <code>all events</code> keyword between <code>insert</code> and <code>into</code> keywords (similar to how it is done for streams).</p><p>For more information, see <a href="#event-type">Event Type</a>.</p><p><strong>Example</strong></p><p>This query inserts all events from the <code>TempStream</code> stream to the <code>OneMinTempWindow</code> window.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(tempId string, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW OneMinTempWindow(tempId string, temp double) time(1 min);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into OneMinTempWindow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="join-window">Join (Window)<a class="hash-link" href="#join-window" title="Direct link to heading">​</a></h3><p>To allow a stream to retrieve information from a window based on a condition.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A join can also be performed with <a href="#join-stream">two streams</a>, <a href="#join-aggregation">aggregation</a> or with tables <a href="#join-table">tables</a>.</p></div></div><p><strong>Syntax</strong></p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">output stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">condition</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>This Stream Application performs a join count the number of temperature events having more then 40 degrees within the last 2 minutes.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW TwoMinTempWindow (roomNo int, temp double) time(2 min);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM CheckStream (requestId string);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into HighTempCountStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select requestId, count(T.temp) as count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from CheckStream as C join TwoMinTempWindow as T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on T.temp &gt; 40;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Supported join types</strong></p><p>Window join supports following operations of a join clause.</p><ul><li><p><strong>Inner join (join)</strong></p><p>This is the default behaviour of a join operation. <code>join</code> is used as the keyword to join two windows or a stream with a window. The output is generated only if there is a matching event in both stream/window.</p></li><li><p><strong>Left outer join</strong></p><p>The <code>left outer join</code> operation allows you to join two windows or a stream with a window to be merged based on a condition.
Here, it returns all the events of left stream/window even if there are no matching events in the right stream/window by
having null values for the attributes of the right stream/window.</p></li><li><p><strong>Right outer join</strong></p><p>This is similar to a left outer join. <code>Right outer join</code> is used as the keyword to join two windows or a stream with a window.
It returns all the events of the right stream/window even if there are no matching events in the left stream/window.</p></li><li><p><strong>Full outer join</strong></p><p>The full outer join combines the results of <code>left outer join</code> and <code>right outer join</code>. <code>full outer join</code> is used as the keyword to join two windows or a stream with a window.
Here, output event are generated for each incoming event even if there are no matching events in the other stream/window.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="from">From<a class="hash-link" href="#from" title="Direct link to heading">​</a></h3><p>A window can be an input to a query, similar to streams.</p><p>Note !!!
When window is used as an input to a query, another window cannot be applied on top of this.</p><p><strong>Syntax</strong></p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">output stream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">attribute name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">window</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>This Stream Application calculates the maximum temperature within the last 5 minutes.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WINDOW FiveMinTempWindow (roomNo int, temp double) time(5 min);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into MaxSensorReadingStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select max(temp) as maxValue, roomNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from FiveMinTempWindow;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="trigger">Trigger<a class="hash-link" href="#trigger" title="Direct link to heading">​</a></h2><p>Triggers allow events to be periodically generated. <strong>Trigger definition</strong> can be used to define a trigger. A trigger also works like a stream with a predefined schema.</p><p><strong>Purpose</strong></p><p>For some use cases the system should be able to periodically generate events based on a specified time interval to perform some periodic executions.</p><p>A trigger can be performed for a <code>&#x27;start&#x27;</code> operation, for a given <code>&lt;time interval&gt;</code>, or for a given <code>&#x27;&lt;cron expression&gt;&#x27;</code>.</p><p><strong>Syntax</strong></p><p>The syntax for a trigger definition is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TRIGGER &lt;trigger name&gt; at (&#x27;start&#x27;| every &lt;time interval&gt;| &#x27;&lt;cron expression&gt;&#x27;);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similar to streams, triggers can be used as inputs. They adhere to the following stream definition and produce the <code>triggered_time</code> attribute of the <code>long</code> type.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM &lt;trigger name&gt; (triggered_time long);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following types of triggeres are currently supported:</p><table><thead><tr><th>Trigger type</th><th>Description</th></tr></thead><tbody><tr><td><code>&#x27;start&#x27;</code></td><td>An event is triggered when Stream is started.</td></tr><tr><td><code>every &lt;time interval&gt;</code></td><td>An event is triggered periodically at the given time interval.</td></tr><tr><td><code>&#x27;&lt;cron expression&gt;&#x27;</code></td><td>An event is triggered periodically based on the given cron expression. For configuration details, see <a href="http://www.quartz-scheduler.org/documentation/quartz-2.1.7/tutorials/tutorial-lesson-06.html" target="_blank" rel="noopener noreferrer">quartz-scheduler</a>.</td></tr></tbody></table><p><strong>Examples</strong></p><ul><li><p>Triggering events regularly at specific time intervals</p><p>  The following query triggers events every 5 minutes.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TRIGGER FiveMinTriggerStream at every 5 min;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Triggering events at a specific time on specified days</p><p>  The following query triggers an event at 10.15 AM on every weekdays.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TRIGGER FiveMinTriggerStream at &#x27;0 15 10 ? * MON-FRI&#x27;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="script">Script<a class="hash-link" href="#script" title="Direct link to heading">​</a></h2><p>Scripts allow you to write functions in other programming languages and execute them within Stream queries. Functions defined via scripts can be accessed in queries similar to any other inbuilt function. <strong>Function definitions</strong> can be used to define these scripts.</p><p>Function parameters are passed into the function logic as <code>Object[]</code> and with the name <code>data</code> .</p><p><strong>Purpose</strong></p><p>Scripts allow you to define a function operation that is not provided in Stream core or its extension. It is not required to write an extension to define the function logic.</p><p><strong>Syntax</strong></p><p>The syntax for a Script definition is as follows.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">define function &lt;function name&gt;[&lt;language name&gt;] return &lt;return type&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;operation of the function&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following parameters are configured when defining a script.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>function name</code></td><td>The name of the function (<code>camelCase</code> is used for the function name) as a convention.</td></tr><tr><td><code>language name</code></td><td>The name of the programming language used to define the script, such as <code>javascript</code>, <code>r</code> and <code>scala</code>.</td></tr><tr><td><code>return type</code></td><td>The attribute type of the function’s return. This can be <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>string</code>, <code>bool</code> or <code>object</code>. Here the function implementer should be responsible for returning the output attribute on the defined return type for proper functionality.</td></tr><tr><td><code>operation of the function</code></td><td>Here, the execution logic of the function is added. This logic should be written in the language specified under the <code>language name</code>, and it should return the output in the data type specified via the <code>return type</code> parameter.</td></tr></tbody></table><p><strong>Examples</strong></p><p>This query performs concatenation using JavaScript, and returns the output as a string.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">define function concatFn[javascript] return string {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var str1 = data[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var str2 = data[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var str3 = data[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var responce = str1 + str2 + str3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return responce;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TempStream(deviceID long, roomNo int, temp double);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">insert into DeviceTempStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select concatFn(roomNo,&#x27;-&#x27;,deviceID) as id, temp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TempStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="store-1">Store<a class="hash-link" href="#store-1" title="Direct link to heading">​</a></h2><p>Stream store queries are a set of on-demand queries that can be used to perform operations on Stream tables, windows, and aggregators.</p><p><strong>Purpose</strong></p><p>Store queries allow you to execute the following operations on Stream tables, windows, and aggregators without the intervention of streams.</p><p>Queries supported for tables:</p><ul><li>INSERT</li><li>SELECT</li><li>DELETE</li><li>UPDATE</li><li>UPDATE OR INSERT</li></ul><p>Queries supported for windows and aggregators:</p><ul><li>SELECT</li></ul><p>This is be done by submitting the store query to the Stream application runtime using its <code>query()</code> method.</p><p>In order to execute store queries, the Stream application of the Stream application runtime you are using, should have a store defined, which contains the table that needs to be queried.</p><p><strong>Example</strong></p><p>If you need to query the table named <code>RoomTypeTable</code> the it should have been defined in the Stream application.</p><p>In order to execute a store query on <code>RoomTypeTable</code>, you need to submit the store query using <code>query()</code> method.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tablewindow-select"><em>(Table/Window)</em> Select<a class="hash-link" href="#tablewindow-select" title="Direct link to heading">​</a></h3><p>The <code>SELECT</code> store query retrieves records from the specified table or window, based on the given condition.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;table/window&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;on condition&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;group by&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;having&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;order by&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;limit&gt;?</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>This query retrieves room numbers and types of the rooms starting from room no 10.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select roomNo, type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from roomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on roomNo &gt;= 10;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="aggregation-select"><em>(Aggregation)</em> Select<a class="hash-link" href="#aggregation-select" title="Direct link to heading">​</a></h3><p>The <code>SELECT</code> store query retrieves records from the specified aggregation, based on the given condition, time range,
and granularity.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">from &lt;aggregation&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;on condition&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">within &lt;time range&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">per &lt;time granularity&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;group by&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;having&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;order by&gt;?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;limit&gt;?</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>Following aggregation definition will be used for the examples.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE STREAM TradeStream (symbol string, price double, volume long, timestamp long);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE AGGREGATION TradeAggregation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  select symbol, avg(price) as avgPrice, sum(price) as total</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    group by symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aggregate by timestamp every sec ... year</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  from TradeStream;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This query retrieves daily aggregations within the time range <code>&quot;2014-02-15 00:00:00 +05:30&quot;, &quot;2014-03-16 00:00:00 +05:30&quot;</code> (Please note that +05:30 can be omitted if timezone is GMT)</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select symbol, total, avgPrice </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TradeAggregation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within &quot;2014-02-15 00:00:00 +05:30&quot;, &quot;2014-03-16 00:00:00 +05:30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per &quot;days&quot;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This query retrieves hourly aggregations of &quot;FB&quot; symbol within the day <code>2014-02-15</code>.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select symbol, total, avgPrice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from TradeAggregation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  on symbol == &quot;FB&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  within &quot;2014-02-15 **:**:** +05:30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per &quot;hours&quot;;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="insert-2">Insert<a class="hash-link" href="#insert-2" title="Direct link to heading">​</a></h3><p>This allows you to insert a new record to the table with the attribute values you define in the <code>select</code> section.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Example</strong></p><p>This store query inserts a new record to the table <code>RoomOccupancyTable</code>, with the specified attribute values.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">insert into RoomOccupancyTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select 10 as roomNo, 2 as people</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="delete-1">Delete<a class="hash-link" href="#delete-1" title="Direct link to heading">​</a></h3><p>The <code>DELETE</code> store query deletes selected records from a specified table.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;select&gt;?  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete &lt;table&gt;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on &lt;conditional expresssion&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which records are selected to be deleted.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes must always be referred to with the table name as shown below:
<code>&lt;table name&gt;.&lt;attibute name&gt;</code>.</p></div></div><p><strong>Example</strong></p><p>In this example, query deletes a record in the table named <code>RoomTypeTable</code> if it has value for the <code>roomNo</code> attribute that matches the value for the <code>roomNumber</code> attribute of the selection which has 10 as the actual value.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select 10 as roomNumber</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on RoomTypeTable.roomNo == roomNumber;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">delete RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on RoomTypeTable.roomNo == 10;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="update-1">Update<a class="hash-link" href="#update-1" title="Direct link to heading">​</a></h3><p>The <code>UPDATE</code> store query updates selected attributes stored in a specific table, based on a given condition.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, &lt;table&gt;.&lt;attribute name&gt; = (&lt;attribute name&gt;|&lt;expression&gt;)?, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which records are selected to be updated. When specifying the <code>condition</code>, table attributes must be referred to with the table name.</p><p>You can use the <code>set</code> keyword to update selected attributes from the table. Here, for each assignment, the attribute specified in the left must be the table attribute, and the one specified in the right can be a stream/table attribute a mathematical operation, or other. When the <code>set</code> clause is not provided, all the attributes in the table are updated.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes must always be referred to with the table name as shown below:
<code>&lt;table name&gt;.&lt;attibute name&gt;</code>.</p></div></div><p><strong>Example</strong></p><p>The following query updates the room occupancy by increasing the value of <code>people</code> by 1, in the <code>RoomOccupancyTable</code> table for each room number greater than 10.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select 10 as roomNumber, 1 as arrival</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set RoomTypeTable.people = RoomTypeTable.people + arrival</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomTypeTable.roomNo == roomNumber;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">update RoomTypeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set RoomTypeTable.people = RoomTypeTable.people + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomTypeTable.roomNo == 10;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="update-or-insert-1">Update or Insert<a class="hash-link" href="#update-or-insert-1" title="Direct link to heading">​</a></h3><p>This allows you to update selected attributes if a record that meets the given conditions already exists in the specified  table.
If a matching record does not exist, the entry is inserted as a new record.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;attribute name&gt;, &lt;attribute name&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, &lt;table&gt;.&lt;attribute name&gt; = &lt;expression&gt;, ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on &lt;condition&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>condition</code> element specifies the basis on which records are selected for update. When specifying the <code>condition</code>, table attributes should be referred to with the table name. If a record that matches the condition does not already exist in the table, the arriving event is inserted into the table.</p><p>The <code>set</code> clause is only used when an update is performed during the insert/update operation. When <code>set</code> clause is used, the attribute to the left is always a table attribute, and the attribute to the right can be a stream/table attribute, mathematical operation or other. The attribute to the left (i.e., the attribute in the event table) is updated with the value of the attribute to the right if the given condition is met. When the <code>set</code> clause is not provided, all the attributes in the table are updated.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Table attributes must always be referred to with the table name as shown below:
<code>&lt;table name&gt;.&lt;attibute name&gt;</code>.</p></div></div><p><strong>Example</strong></p><p>The following query tries to update the records in the <code>RoomAssigneeTable</code> table that have room numbers that match the same in the selection. If such records are not found, it inserts a new record based on the values provided in the selection.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">select 10 as roomNo, &quot;single&quot; as type, &quot;abc&quot; as assignee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update or insert into RoomAssigneeTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set RoomAssigneeTable.assignee = assignee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    on RoomAssigneeTable.roomNo == roomNo;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="event-playback">Event Playback<a class="hash-link" href="#event-playback" title="Direct link to heading">​</a></h3><p>When <code>@app:playback</code> annotation is added to the app, the timestamp of the event (specified via an attribute) is treated as the current time. This results in events being processed faster.</p><p>The following elements are configured with this annotation.</p><table><thead><tr><th>Annotation</th><th>Description</th></tr></thead><tbody><tr><td><code>idle.time</code></td><td>If no events are received during a time interval specified (in milliseconds) via this element, the Stream system time is incremented by a number of seconds specified via the <code>increment</code> element.</td></tr><tr><td><code>increment</code></td><td>The number of seconds by which the Stream system time must be incremented if no events are received during the time interval specified via the <code>idle.time</code> element.</td></tr></tbody></table><p>e.g., In the following example, the Stream system time is incremented by two seconds if no events arrive for a time interval of 100 milliseconds.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">@app:playback(idle.time = &#x27;100 millisecond&#x27;, increment = &#x27;2 sec&#x27;) </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/macrometacorp/docs/edit/master/docs/cep/reference/query-guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cep/reference/geospatial"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Geospatial</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cep/reference/functions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Functions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#stream-application" class="table-of-contents__link toc-highlight">Stream Application</a><ul><li><a href="#purpose" class="table-of-contents__link toc-highlight">Purpose</a></li></ul></li><li><a href="#stream" class="table-of-contents__link toc-highlight">Stream</a><ul><li><a href="#syntax-1" class="table-of-contents__link toc-highlight">Syntax</a></li><li><a href="#source" class="table-of-contents__link toc-highlight">Source</a></li><li><a href="#sink" class="table-of-contents__link toc-highlight">Sink</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error Handling</a></li></ul></li><li><a href="#query" class="table-of-contents__link toc-highlight">Query</a><ul><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#value" class="table-of-contents__link toc-highlight">Value</a></li><li><a href="#select" class="table-of-contents__link toc-highlight">Select</a></li><li><a href="#function" class="table-of-contents__link toc-highlight">Function</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">Filter</a></li><li><a href="#window" class="table-of-contents__link toc-highlight">Window</a></li><li><a href="#event-type" class="table-of-contents__link toc-highlight">Event Type</a></li><li><a href="#aggregate-function" class="table-of-contents__link toc-highlight">Aggregate Function</a></li><li><a href="#group-by" class="table-of-contents__link toc-highlight">Group By</a></li><li><a href="#having" class="table-of-contents__link toc-highlight">Having</a></li><li><a href="#order-by" class="table-of-contents__link toc-highlight">Order By</a></li><li><a href="#limit--offset" class="table-of-contents__link toc-highlight">Limit &amp; Offset</a></li><li><a href="#join-stream" class="table-of-contents__link toc-highlight">Join (Stream)</a></li><li><a href="#patterns" class="table-of-contents__link toc-highlight">Patterns</a></li><li><a href="#sequence" class="table-of-contents__link toc-highlight">Sequence</a></li><li><a href="#output-rate-limiting" class="table-of-contents__link toc-highlight">Output rate limiting</a></li></ul></li><li><a href="#partition" class="table-of-contents__link toc-highlight">Partition</a><ul><li><a href="#inner-stream" class="table-of-contents__link toc-highlight">Inner Stream</a></li><li><a href="#purge-partition" class="table-of-contents__link toc-highlight">Purge Partition</a></li></ul></li><li><a href="#table-collection" class="table-of-contents__link toc-highlight">Table (Collection)</a><ul><li><a href="#primary-keys" class="table-of-contents__link toc-highlight">Primary Keys</a></li><li><a href="#indexes" class="table-of-contents__link toc-highlight">Indexes</a></li><li><a href="#store" class="table-of-contents__link toc-highlight">Store</a></li><li><a href="#insert" class="table-of-contents__link toc-highlight">Insert</a></li><li><a href="#join-table" class="table-of-contents__link toc-highlight">Join (Table)</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">Delete</a></li><li><a href="#update" class="table-of-contents__link toc-highlight">Update</a></li><li><a href="#update-or-insert" class="table-of-contents__link toc-highlight">Update or Insert</a></li><li><a href="#in" class="table-of-contents__link toc-highlight">In</a></li></ul></li><li><a href="#named-aggregation" class="table-of-contents__link toc-highlight">Named Aggregation</a><ul><li><a href="#distributed-aggregation" class="table-of-contents__link toc-highlight">Distributed Aggregation</a></li><li><a href="#join-aggregation" class="table-of-contents__link toc-highlight">Join (Aggregation)</a></li></ul></li><li><a href="#named-window" class="table-of-contents__link toc-highlight">Named Window</a><ul><li><a href="#insert-1" class="table-of-contents__link toc-highlight">Insert</a></li><li><a href="#join-window" class="table-of-contents__link toc-highlight">Join (Window)</a></li><li><a href="#from" class="table-of-contents__link toc-highlight">From</a></li></ul></li><li><a href="#trigger" class="table-of-contents__link toc-highlight">Trigger</a></li><li><a href="#script" class="table-of-contents__link toc-highlight">Script</a></li><li><a href="#store-1" class="table-of-contents__link toc-highlight">Store</a><ul><li><a href="#tablewindow-select" class="table-of-contents__link toc-highlight"><em>(Table/Window)</em> Select</a></li><li><a href="#aggregation-select" class="table-of-contents__link toc-highlight"><em>(Aggregation)</em> Select</a></li><li><a href="#insert-2" class="table-of-contents__link toc-highlight">Insert</a></li><li><a href="#delete-1" class="table-of-contents__link toc-highlight">Delete</a></li><li><a href="#update-1" class="table-of-contents__link toc-highlight">Update</a></li><li><a href="#update-or-insert-1" class="table-of-contents__link toc-highlight">Update or Insert</a></li><li><a href="#event-playback" class="table-of-contents__link toc-highlight">Event Playback</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/essentials/overview">Essentials</a></li></ul></div><div class="col footer__col"><div class="footer__title">SDKs &amp; Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Macrometacorp/jsC8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Javascript<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Macrometacorp/pyC8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.npmjs.com/package/gdnsl" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/macrometa" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/macrometacorp/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Macrometa</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.695a231d.js"></script>
<script src="/docs/assets/js/main.b8dbb911.js"></script>
</body>
</html>